<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.110.0">
<link rel="canonical" type="text/html" href="https://eclipse-leda.github.io/leda/docs/general-usage/utilities/">
<link rel="alternate" type="application/rss&#43;xml" href="https://eclipse-leda.github.io/leda/docs/general-usage/utilities/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/leda/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/leda/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/leda/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/leda/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/leda/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/leda/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/leda/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/leda/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/leda/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/leda/favicons/android-192x192.png" sizes="192x192">

<title>Utilities | Eclipse Leda Documentation</title>
<meta name="description" content="">
<meta property="og:title" content="Utilities" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://eclipse-leda.github.io/leda/docs/general-usage/utilities/" />
<meta itemprop="name" content="Utilities">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Utilities"/>
<meta name="twitter:description" content=""/>




<link rel="preload" href="/leda/scss/main.min.66eb937ad37fec07780efad5e1d636bcf184d4f4564fc29749e24a254badb6ca.css" as="style">
<link href="/leda/scss/main.min.66eb937ad37fec07780efad5e1d636bcf184d4f4564fc29749e24a254badb6ca.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar navbar-dark js-navbar-scroll">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/leda/"><span class="navbar-brand__logo navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="30 270 300 300" id="svg2"><defs id="defs6"><clipPath id="clipPath24" clipPathUnits="userSpaceOnUse"><path id="path22" d="m5116.71 2737.03v81.36c0 51.02 13.61 71.72 55.28 74.55h288.29v-182.27c-4.26-34.29-16.73-48.19-55.28-48.19h-226.21c-47.05.0-62.08 20.69-62.08 74.55zm-139.46 17.86c0-128.41 84.19-198.71 222.24-198.71h42.8c107.43.0 184.82 2.84 217.99 84.19v-84.19h137.76v534.05c0 128.13-97.8 198.71-235.85 198.71H5051.8v-106.3h360c36 0 48.48-23.52 48.48-60.66v-122.74h-260.79c-138.05.0-222.24-70.59-222.24-198.71zm-332.5-44.22c-3.97-34.29-16.44-48.19-55-48.19h-225.07c-46.76.0-62.08 20.69-62.08 74.55v371.06c0 51.03 13.9 71.71 55.28 74.55h231.87c41.39-2.84 55-23.52 55-74.55zm139.46 854.08h-138.04v-360c-33.17 81.36-110.28 84.19-217.99 84.19h-42.8c-137.77.0-221.96-70.58-221.96-198.71v-335.34c0-128.41 84.19-198.71 221.96-198.71h42.8c107.71.0 184.82 2.84 217.99 84.19v-84.19h138.04zm-925.8-587.62h-362.83v144.85c0 28.91 12.47 60.66 48.2 60.66h266.45c35.71.0 48.18-31.75 48.18-60.66zm139.47-106.3v219.4c0 128.13-98.08 198.71-236.13 198.71h-169.51c-138.04.0-235.84-70.58-235.84-198.71v-335.34c0-128.41 97.8-198.71 235.84-198.71h405.64v106.3h-454.1c-35.73.0-48.2 23.54-48.2 60.66v147.69zM2642.92 2556.18h630.71v117.36h-483.02v794.55h-147.69z"/></clipPath><linearGradient id="linearGradient34" spreadMethod="pad" gradientTransform="matrix(2955.12,0,0,-2955.12,2642.92,3060.47)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop26" offset="0" style="stop-opacity:1;stop-color:#77add1"/><stop id="stop28" offset=".189014" style="stop-opacity:1;stop-color:#64c6ee"/><stop id="stop30" offset=".994475" style="stop-opacity:1;stop-color:#7b3199"/><stop id="stop32" offset="1" style="stop-opacity:1;stop-color:#7b3199"/></linearGradient><linearGradient id="linearGradient44" spreadMethod="pad" gradientTransform="matrix(1875.15,0,0,-1875.15,364.686,2981.28)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop38" offset="0" style="stop-opacity:1;stop-color:#7cd3c9"/><stop id="stop40" offset=".994475" style="stop-opacity:1;stop-color:#912d99"/><stop id="stop42" offset="1" style="stop-opacity:1;stop-color:#912d99"/></linearGradient><clipPath id="clipPath54" clipPathUnits="userSpaceOnUse"><path id="path52" d="m760.719 2701.88c88.719-132.65 206.929-250.3 356.031-352.34 37.13-25.23 79.65-36.85 121.32-34.58 41.39 1.98 82.49 17.85 116.79 46.77 130.11 110.26 233.01 236.97 307.27 381.26 73.14 142.01 118.49 300.76 134.36 477.63 3.97 43.66-7.65 85.61-30.89 120.2-23.81 35.43-59.53 63.49-102.9 77.95-160.16 54.42-320.88 77.38-482.74 68.03-162.43-9.35-326.269-51.31-492.659-127.28-40.821-18.7-72.285-48.75-91.281-85.04-18.704-36.28-25.508-78.52-17.29-121.89 31.75-165.26 91.848-316.06 181.989-450.71zm300.751-433.41c-159.306 109.13-286.298 235.84-382.111 378.99-97.793 145.99-162.992 308.69-197.004 486.71-12.472 65.48-1.984 130.11 26.926 185.39 28.918 55.27 76.25 101.19 137.481 128.97 177.734 81.36 353.478 126.14 527.818 136.35 174.61 9.92 347.52-14.74 519.59-73.14 64.06-21.82 117.07-63.49 152.78-116.5 35.15-52.73 53.01-116.79 47.06-183.4-17.3-189.92-66.05-360.85-144.85-513.64-79.94-155.91-191.06-292.82-331.09-411.31-51.02-43.08-112.54-66.61-175.18-69.73-62.65-3.4-126.14 13.61-181.42 51.31z"/></clipPath><linearGradient id="linearGradient70" spreadMethod="pad" gradientTransform="matrix(1417.96,0,0,-1417.96,477.178,2901.88)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop56" offset="0" style="stop-opacity:1;stop-color:#bce263"/><stop id="stop58" offset=".11811164" style="stop-opacity:1;stop-color:#bce263"/><stop id="stop60" offset=".509456" style="stop-opacity:1;stop-color:#7ab43c"/><stop id="stop62" offset=".76356415" style="stop-opacity:1;stop-color:#7ab43c"/><stop id="stop64" offset=".994475" style="stop-opacity:1;stop-color:#4e9133"/><stop id="stop66" offset=".99510668" style="stop-opacity:1;stop-color:#4e9133"/><stop id="stop68" offset="1" style="stop-opacity:1;stop-color:#4e9133"/></linearGradient><linearGradient id="linearGradient80" spreadMethod="pad" gradientTransform="matrix(942.78,0,0,-942.78,720.659,3019.8)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop74" offset="0" style="stop-opacity:1;stop-color:#7cd3c9"/><stop id="stop76" offset=".994475" style="stop-opacity:1;stop-color:#912d99"/><stop id="stop78" offset="1" style="stop-opacity:1;stop-color:#912d99"/></linearGradient></defs><g transform="matrix(1.3333333,0,0,-1.3333333,0,795.04)" id="g10"><g transform="scale(0.1)" id="g12"><path id="path46" style="fill:url(#linearGradient44);fill-opacity:1;fill-rule:evenodd;stroke:none" d="m462.512 2989.03c1.133-223.65 47.902-452.13 142.867-685.13 24.66-60.94 67.465-109.13 120.187-139.47 52.727-30.61 115.657-43.93 180.852-35.14 236.122 32.03 453.262 104.03 650.552 218.55 193.89 112.53 368.79 266.17 523.27 463.18 41.11 52.15 61.8 113.67 61.8 174.9.28 61.51-20.13 123.02-60.95 175.18-145.7 186.8-317.19 337.89-515.62 450.99-194.74 110.83-415.84 185.1-665.005 220.82-65.481 9.36-128.692-3.4-181.699-33.74C665.758 3768.85 622.672 3720.94 597.441 3660c-90.14-219.4-136.062-443.06-134.929-670.97zm51.875-721.98c-99.5 244.06-148.535 484.73-149.668 721.42-1.418 241.23 47.054 477.63 142.297 708.66 33.73 81.92 91.843 146.27 163.273 187.08 71.719 40.82 156.473 58.11 244.066 45.64 261.355-37.13 494.075-115.65 699.595-232.72 209.76-119.34 390.61-278.65 544.25-475.66 54.71-70.01 81.92-152.78 81.63-235.55.0-83.06-27.49-165.83-82.2-235.56-162.42-206.65-346.68-368.5-551.62-487.27-208.35-121.05-437.67-197.02-686.549-230.75-87.313-11.9-171.785 5.95-242.934 47.05-71.433 41.39-128.976 106.02-162.14 187.66v0"/><g id="g48"><g clip-path="url(#clipPath54)" id="g50"><path id="path72" style="fill:url(#linearGradient70);fill-opacity:1;fill-rule:nonzero;stroke:none" d="m760.719 2701.88c88.719-132.65 206.929-250.3 356.031-352.34 37.13-25.23 79.65-36.85 121.32-34.58 41.39 1.98 82.49 17.85 116.79 46.77 130.11 110.26 233.01 236.97 307.27 381.26 73.14 142.01 118.49 300.76 134.36 477.63 3.97 43.66-7.65 85.61-30.89 120.2-23.81 35.43-59.53 63.49-102.9 77.95-160.16 54.42-320.88 77.38-482.74 68.03-162.43-9.35-326.269-51.31-492.659-127.28-40.821-18.7-72.285-48.75-91.281-85.04-18.704-36.28-25.508-78.52-17.29-121.89 31.75-165.26 91.848-316.06 181.989-450.71zm300.751-433.41c-159.306 109.13-286.298 235.84-382.111 378.99-97.793 145.99-162.992 308.69-197.004 486.71-12.472 65.48-1.984 130.11 26.926 185.39 28.918 55.27 76.25 101.19 137.481 128.97 177.734 81.36 353.478 126.14 527.818 136.35 174.61 9.92 347.52-14.74 519.59-73.14 64.06-21.82 117.07-63.49 152.78-116.5 35.15-52.73 53.01-116.79 47.06-183.4-17.3-189.92-66.05-360.85-144.85-513.64-79.94-155.91-191.06-292.82-331.09-411.31-51.02-43.08-112.54-66.61-175.18-69.73-62.65-3.4-126.14 13.61-181.42 51.31v0"/></g></g><path id="path82" style="fill:url(#linearGradient80);fill-opacity:1;fill-rule:evenodd;stroke:none" d="m935.898 3147.21c-54.71-85.89-93.543-185.38-115.085-298.77-4.821-24.94-1.418-49.33 9.07-69.74 10.207-20.69 27.496-37.98 49.605-48.75 97.508-46.78 197.292-73.42 300.192-78.81 101.19-5.1 205.51 9.92 312.94 46.78 23.81 8.21 42.81 23.53 55.56 42.8 12.48 19.56 18.71 43.37 16.44 68.88-9.07 108.28-36.57 208.92-83.9 301.61-46.49 91.28-111.97 175.18-197.58 251.15-18.71 16.44-41.1 25.51-63.78 26.93-22.67 1.13-45.92-5.11-66.33-19.28-88.72-61.51-161.292-135.78-217.132-222.8zM724.434 2866.87c24.093 125.28 67.461 236.12 128.976 332.78 63.211 98.93 144.563 182.27 243.5 250.87 38.83 27.21 83.9 39.11 128.12 36.56 44.22-2.55 87.31-19.84 123.03-51.59 95.24-84.47 168.37-178.01 220.25-279.78 53-104.31 84.19-217.14 94.39-337.89 3.97-47.61-8.22-92.98-32.6-130.39-24.09-37.42-60.66-66.9-105.45-82.21-119.34-41.1-236.12-57.83-349.79-51.87-115.94 6.24-228.473 36-337.325 88.44-42.805 20.41-75.398 53.29-95.242 92.98-19.848 39.68-26.648 85.6-17.859 132.1v0"/></g></g></svg></span><span class="navbar-brand__name">Eclipse Leda Documentation</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/eclipse-leda" target="_blank" rel="noopener"><span>GitHub</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/leda/offline-search-index.99d03c2498de4366dfb7c62a17adeb3d.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/leda/docs/general-usage/utilities/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Utilities</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-3f128b6db32e0070ea241702cbec5b5a">SDV Health</a></li>


    
  
    
    
	
<li>2: <a href="#pg-10e59a808c83f8d618fe3bc28e3036df">KantUI</a></li>


    
  
    
    
	
<li>3: <a href="#pg-d9746e3a6d66da060fdb23a60b0de675">SDV Device Info</a></li>


    
  
    
    
	
<li>4: <a href="#pg-3c67a096a6fae106d00fcde4855f3b69">SDV Provision</a></li>


    
  
    
    
	
<li>5: <a href="#pg-163a39aced07d88ca24900280481599f">SDV MotD</a></li>


    
  
    
    
	
<li>6: <a href="#pg-51f7159b12485284fa7fa1ce5861b643">CAN Forward</a></li>


    
  
    
    
	
<li>7: <a href="#pg-39ff94ee053885f2bdf2856385b76f7a">Kanto Auto Deployer (KAD)</a></li>


    
  
    
    
	
<li>8: <a href="#pg-67a8cb2fda94b33fb5cc6d522b276d75">SDV Container Exec</a></li>


    
  
    
    
	
<li>9: <a href="#pg-080b94ccd41bc5e866333b5c591b2719">SDV Kanto-Ctl</a></li>


    
  
    
    
	
<li>10: <a href="#pg-53d93802459a7c403107ddd63dfecfde">Blueprint Selector</a></li>


    
  

    </ul>


<div class="content">
      <p>The quickstart image contains the following utilities.
These utility scripts are meant to be convenience tools for users and developers.
They help to experiment with the container deployment, device provisioning or vehicle data access.</p>
<ul>
<li><strong>sdv-health:</strong> Show SDV software components health status</li>
<li><strong>kantui:</strong> A text user interface for kanto-cm to manage containers (start, stop, logs, redeploy all)</li>
<li><strong>sdv-device-info:</strong> Show and update device information</li>
<li><strong>sdv-provision:</strong> Generate device certificates and configuration of cloud connection</li>
<li><strong>sdv-motd:</strong> Message-of-the-Day shown after login prompt</li>
<li><strong>can-forward:</strong> Forwarding a CAN-bus network interface into a containerized Vehicle Application</li>
<li><strong>kanto-auto-deployer:</strong> Automatically deploys containers on boot. Runs as a systemd service, and can also be invoked by a user directly.</li>
<li><strong>sdv-ctr-exec:</strong> Execute arbitrary commands in existing containers</li>
<li><strong>sdv-kanto-ctl:</strong> Manage the Kanto Container Management configuration via CLI</li>
<li><strong>blueprint-selector:</strong> Deploy and fetch new SDV blueprints easily with an interactive CLI</li>
</ul>
<blockquote>
<p>Note:
These scripts are not meant to be reused or called from production software.
Their behaviour or command line syntax is not a stable API and should not be trusted for automation purposes.
For details, please see <a href="https://github.com/eclipse-leda/leda-utils/">leda-utils</a></p>
</blockquote>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3f128b6db32e0070ea241702cbec5b5a">1 - SDV Health</h1>
    
	<h2 id="health-check">Health check</h2>
<p>The sdv-health utility displays a status overview of some important dependencies and device configurations for the SDV edge stack.
The sdv health utility can be configured using the sdv.conf configuration file.</p>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># sdv-health</span>
</span></span></code></pre></div><p>Example output:</p>
<p><img src="../sdv-health-output.png" alt="SDV Health Example Output"></p>
<h3 id="version-information">Version Information</h3>
<p>The Leda image version and build time will be displayed at the top in the first category:</p>
<ul>
<li>OS Release: Year and codename of the release version</li>
<li>Image Version: Name of the image and more specific version information, such as the git tag or commit id</li>
<li>Build timestamp in <code>yyyMMddHHmmss</code> notation</li>
</ul>
<blockquote>
<p>Note: The information is read from the system base file in <code>/etc/os-release</code>:</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# cat /etc/os-release 
</span></span><span style="display:flex;"><span><span style="color:#000">BUILD_ID</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;20230309083051&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">DISTRO_CODENAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Dracon&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ID</span><span style="color:#ce5c00;font-weight:bold">=</span>leda
</span></span><span style="display:flex;"><span><span style="color:#000">IMAGE_VERSION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;0.0.5-41-g82f2b12&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">NAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Eclipse Leda&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PRETTY_NAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Eclipse Leda 2023 (Dracon)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">VERSION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;2023 (Dracon)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">VERSION_CODENAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Dracon&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">VERSION_ID</span><span style="color:#ce5c00;font-weight:bold">=</span>0.0.5-41-g82f2b12
</span></span></code></pre></div><h3 id="bus-networks">Bus networks</h3>
<p>If available, vehicle bus network information, such as the status of the CAN-Bus, will be displayed iin its own category.
This helps to quickly identify if there problems with the hardware connectivity for automotive bus networks.</p>
<h3 id="ports">Ports</h3>
<p>The health utility checks the TCP ports of specific services.
This helps to identify if these services are up and running and potentiallyconnectable via external network interfaces.</p>
<h3 id="services-and-containers">Services and Containers</h3>
<p>The services category shows the status of required and optional containers.
The required containers are supposed to be up and running for the SDV.EDGE stack to be correctly up and running.
If any of these core components have a failed state, the functionality is impacted.</p>
<p>The optional containers are for additional features and for example applications.
These containers may not be necessary for each use case and hence will be marked as a warning if they are not up and running.
The overview still helps to identify which containers are working properly.</p>
<h3 id="errors-warnings-failed-states">Errors, Warnings, Failed states</h3>
<p>When there are errors or warnings related to the status of SDV related components,
the health utility will print out these error states, and if available also a more detailed error message.</p>
<p>In the following example, the health utility helps the troubleshooting process:</p>
<ul>
<li>The container runtime is properly started: &ldquo;Kanto CM&rdquo; is OK in the &ldquo;SDV Ports&rdquo; section and the &ldquo;container-management&rdquo; service is OK in the &ldquo;SDV Services&rdquo; section&quot;.</li>
<li>Some containers are in state &ldquo;OK&rdquo;, which means there is no general issue with the container runtime.</li>
<li>The cloud connector is in a &ldquo;Stopped&rdquo; state, which indicates that the user manually stopped the container by using &ldquo;kanto-cm stop -n cloud-connector&rdquo;.</li>
<li>The sua container is in a &ldquo;Exited&rdquo; state, which indicates the process exited with an error code.</li>
</ul>
<p><img src="../sdv-health-example-errors2.png" alt="SDV Health Example Errors"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-10e59a808c83f8d618fe3bc28e3036df">2 - KantUI</h1>
    
	<p>The KantoUI tool is a text-based user interface for conveniently managing containers in the Kanto Container Management.
It supports simple navigation using keyboard and mouse to select a specific container.
Commands to start, stop, remove and re-deploy containers are available along with a functionality to retrieve the application logs of a selected container.</p>
<h2 id="kanto-user-interface">Kanto User Interface</h2>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kantui
</span></span></code></pre></div><p>Example output:</p>
<p><img src="../kantui-large.png" alt="KantoUI"></p>
<h2 id="command-line-options">Command Line Options</h2>
<p>Print command line help:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# kantui --help
</span></span><span style="display:flex;"><span>kantui 0.2.0
</span></span><span style="display:flex;"><span>A TUI <span style="color:#204a87;font-weight:bold">for</span> Kanto CM that allows easier management of deployed containers. Requires root.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USAGE:
</span></span><span style="display:flex;"><span>    kantui <span style="color:#ce5c00;font-weight:bold">[</span>OPTIONS<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OPTIONS:
</span></span><span style="display:flex;"><span>    -c, --config-file-path &lt;CONFIG_FILE_PATH&gt;
</span></span><span style="display:flex;"><span>            Set a custom path <span style="color:#204a87;font-weight:bold">for</span> the kantui configuration file <span style="color:#ce5c00;font-weight:bold">[</span>default:
</span></span><span style="display:flex;"><span>            /etc/kantui/kantui_conf.toml<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    -h, --help
</span></span><span style="display:flex;"><span>            Print <span style="color:#204a87">help</span> information
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    -V, --version
</span></span><span style="display:flex;"><span>            Print version information
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Note: All config values can be overridden through env variables prefixed with KANTUI_,
</span></span><span style="display:flex;"><span>e.g. <span style="color:#000">KANTUI_STOP_TIMEOUT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">5</span> overrides the timeout before SIGKILL is sent to be <span style="color:#0000cf;font-weight:bold">5</span> seconds.
</span></span></code></pre></div><h2 id="keyboard-commands">Keyboard commands</h2>
<ul>
<li>Arrow keys <code>Up</code> and <code>Down</code> to select a container</li>
<li>Arrow keys <code>Left</code> and <code>Right</code> to select a column</li>
<li><code>Enter</code> to change the sort ordering of the currently selected column</li>
<li><code>S</code> to <strong>start</strong> the selected container which is currently not running</li>
<li><code>P</code> to <strong>stop</strong> the selected container</li>
<li><code>R</code> to <strong>remove</strong> a container</li>
<li><code>L</code> to show the <strong>log output</strong> of a container</li>
<li><code>D</code> to redeploy an existing container (rereads deployment descriptor)</li>
<li><code>Q</code> to <strong>quit</strong> kantui</li>
</ul>
<blockquote>
<p>Note: The mouse can be used to select ui items when holding the <code>Shift</code> key.</p>
</blockquote>
<h2 id="starting-stopping-removing-containers">Starting, Stopping, Removing containers</h2>
<p>To use the lifecycle commands on a container:</p>
<ol>
<li>Select a container by using the mouse or the arrow keys.</li>
<li>The selected container is highlighted.</li>
<li>Press one of the lifecycle commands, e.g. <code>s</code>, <code>p</code> or <code>r</code></li>
<li>Wait for the value in the <em>State</em> column to change, before issueing the next command.</li>
</ol>
<blockquote>
<p>Note: When using the lifecycle commands for containers (Start, Stop, Remove), it may take a few seconds before the UI is updated with the status changes.
The amount of time before a container is forcefully killed is determined by the <code>stop_timeout</code> configuration option.</p>
</blockquote>
<h2 id="show-container-logs">Show container Logs</h2>
<p>To view the container&rsquo;s log output:</p>
<ol>
<li>Select a container by using the mouse or the arrow keys.</li>
<li>Press the <code>L</code> key</li>
<li>Log output will be displayed (tail, oldest messages first)</li>
<li>Use the arrow keys <code>Up</code> and <code>Down</code> or drag the scrollbar using your mouse to scroll through the log</li>
<li>Close the Log viewer by pressing <code>Enter</code> or clicking on the <code>OK</code> button</li>
</ol>
<blockquote>
<p>Note: The log output is <strong>not followed</strong> automatically. Close the dialog and reopen to see new output.</p>
</blockquote>
<h2 id="redeploying-containers">Redeploying containers</h2>
<p>To redeploy a container, e.g. when a deployment descriptor has changed on disk:</p>
<ol>
<li>Select a container by using the mouse or the arrow keys.</li>
<li>Press the <code>P</code> key to stop the container</li>
<li>Press the <code>R</code> key to remove the container</li>
<li>Press the <code>D</code> key to invoke the Kanto Auto Deployer, which will redeploy the missing containers</li>
</ol>
<blockquote>
<p>Note: Only containers managed by Kanto Auto Deployer will be redeployed.</p>
</blockquote>
<h2 id="column-sorting">Column Sorting</h2>
<p>To sort a column:</p>
<ol>
<li>Select the column using the <code>Left</code> and <code>Right</code> arrow keys</li>
<li>Press <code>Enter</code> to activate sorting</li>
<li>Press <code>Enter</code> again on a sorted column to invert sort order (Ascending -&gt; Descending -&gt; Ascending)</li>
</ol>
<blockquote>
<p>Note: The selected sort order is not persisted and will reset to the default on restart: By <code>ID</code>, ascending</p>
</blockquote>
<h2 id="configuration-file">Configuration File</h2>
<p>The default location of the configuration file is <code>/etc/kantui/kantui_conf.toml</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># General Configuration Options</span>
</span></span><span style="display:flex;"><span><span style="color:#000">socket_path</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;/run/container-management/container-management.sock&#34;</span> <span style="color:#8f5902;font-style:italic"># Path to kanto-cm unix socket</span>
</span></span><span style="display:flex;"><span><span style="color:#000">stop_timeout</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#8f5902;font-style:italic"># timeout (integer) in seconds before a SIGKILL is sent after a SIGTERM</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>keyconfig<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">start_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;[S]tart&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">start_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;s&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">stop_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Sto[P]&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">stop_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;p&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">remove_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;[R]emove&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">remove_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;r&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">logs_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;[L]ogs&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">logs_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;l&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">quit_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;[Q]uit&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">quit_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;q&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">redeploy_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Re[D]eploy&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">redeploy_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Includes a shell lexer so anything that would be a valid shell command can be used</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># No pipes/redirects allowed.</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># N.B.: Command inherits kantui&#39;s privileges (root)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">redeploy_command</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;systemctl restart kanto-auto-deployer.service&#34;</span>
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d9746e3a6d66da060fdb23a60b0de675">3 - SDV Device Info</h1>
    
	<p>Displays the current device configuration, such as Device ID.</p>
<blockquote>
<p>Note: <strong>Requires</strong> the <em>Cloud Connector</em> component to be configured and running.</p>
</blockquote>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-device-info
</span></span></code></pre></div><p><img src="../sdv-device-info-example-output1.png" alt="Eclipse Leda Device Info Example Output"></p>
<h2 id="usage">Usage</h2>
<p>Synposis: <code>./sdv-device-info [options] [command]</code></p>
<p>Full help:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# sdv-device-info --help
</span></span><span style="display:flex;"><span>sdv-device-info v0.2
</span></span><span style="display:flex;"><span>Usage: /usr/bin/sdv-device-info <span style="color:#ce5c00;font-weight:bold">[</span>options<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>command<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Show SDV device configuration information
</span></span><span style="display:flex;"><span>Example: /usr/bin/sdv-device-info show
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Commands:
</span></span><span style="display:flex;"><span> show                 : Display configuration <span style="color:#ce5c00;font-weight:bold">(</span>default <span style="color:#204a87">command</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span> <span style="color:#204a87">help</span>                 : This message
</span></span><span style="display:flex;"><span> env                  : Format output <span style="color:#204a87;font-weight:bold">for</span> use in scripts
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span> --ansi <span style="color:#000;font-weight:bold">|</span> -a      : Don<span style="color:#a40000">&#39;</span>t use colored output.
</span></span><span style="display:flex;"><span> --norestart <span style="color:#000;font-weight:bold">|</span> -n : Do not automatically restart services
</span></span><span style="display:flex;"><span> --verbose <span style="color:#000;font-weight:bold">|</span> -v   : Enable verbose mode.
</span></span><span style="display:flex;"><span> --help <span style="color:#000;font-weight:bold">|</span> -h      : This message.
</span></span></code></pre></div><h2 id="use-in-scripts">Use in scripts</h2>
<p>To use device information on other scripts, it may be useful to source the device information variables into the current environment variable context:</p>
<p>Synposis: <code>source ./sdv-device-info env</code></p>
<p>Example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ <span style="color:#204a87">source</span> ./sdv-device-info env
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#000">$DEVICE_ID</span>
</span></span><span style="display:flex;"><span>exampledevice1
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3c67a096a6fae106d00fcde4855f3b69">4 - SDV Provision</h1>
    
	<p>The provisioning helper script can be used to manually perform a device provisioning with a cloud backend.</p>
<p>It is meant as a convenient tool for developers, who wish to connect their device to a selfmanaged cloud backend directly.
In a production environment, the device provisioning functionality is implemented either by the <em>Cloud Connector</em> component.</p>
<p>The provisioning script currently supports the following backend and authentication options:</p>
<ul>
<li>Azure IoT Hub
<ul>
<li>Connection String</li>
<li>Device Certificates</li>
</ul>
</li>
<li>Azure IoT Device Provisioning Service
<ul>
<li>Device Certificates</li>
</ul>
</li>
</ul>
<h2 id="usage">Usage</h2>
<p>The <em>sdv-provision</em> script is interactive and asks for the type of backend and authentication option:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# sdv-provision 
</span></span><span style="display:flex;"><span>Checking Eclipse Leda Device Provisioning configuration...
</span></span><span style="display:flex;"><span>- Certificates directory exists
</span></span><span style="display:flex;"><span>Checking Device ID
</span></span><span style="display:flex;"><span>- Based on network device: eth0
</span></span><span style="display:flex;"><span>- Device ID: 52-54-21-4c-f9-5a
</span></span><span style="display:flex;"><span>Checking whether either IdScope or ConnectionString is configured
</span></span><span style="display:flex;"><span> - Neither Id Scope file nor ConnectionString found, needs manual configuration
</span></span><span style="display:flex;"><span>Do you want to use the global Azure IoT Device Provisioning Service <span style="color:#ce5c00;font-weight:bold">(</span>DPS<span style="color:#ce5c00;font-weight:bold">)</span> by using an Id Scope, or <span style="color:#204a87;font-weight:bold">do</span> you want to use a direct connection to a specific Azure IoT Hub using a Connection String?
</span></span><span style="display:flex;"><span>d<span style="color:#ce5c00;font-weight:bold">)</span> Azure IoT Device Provisioning Service <span style="color:#ce5c00;font-weight:bold">(</span>DPS<span style="color:#ce5c00;font-weight:bold">)</span> with Id Scope
</span></span><span style="display:flex;"><span>h<span style="color:#ce5c00;font-weight:bold">)</span> Azure IoT Hub with Connection String
</span></span><span style="display:flex;"><span>Choose:d
</span></span><span style="display:flex;"><span>Please enter your Id Scope of the Azure IoT Device Provisioning Service:example
</span></span><span style="display:flex;"><span>Recreating the Cloud Connector container...
</span></span><span style="display:flex;"><span>Checking device certificates
</span></span><span style="display:flex;"><span>- All device certificates are present
</span></span><span style="display:flex;"><span>- Primary device certificate: /data/var/certificates/device.crt
</span></span><span style="display:flex;"><span>- Primary device private key: /data/var/certificates/device.key
</span></span><span style="display:flex;"><span>- Secondary device certificate: /data/var/certificates/device2.crt
</span></span><span style="display:flex;"><span>- Secondary device private key: /data/var/certificates/device2.key
</span></span><span style="display:flex;"><span>Fingerprints <span style="color:#ce5c00;font-weight:bold">(</span>add these to the Azure IoT Hub Device<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>- Primary thumbprint: 1B172ED3D06F4E25AFFEF675ADCE519457FFFFFF
</span></span><span style="display:flex;"><span>- Secondary thumbprint: B6CD5EACE96E9D0448BCB0BAED2DEE87AFFFFFFF
</span></span></code></pre></div><p>Once a configuration has been selected, the script will:</p>
<ul>
<li>Generate a random Device Id (based on physical network address)</li>
<li>Store the Device Id in <code>/etc/deviceid</code></li>
<li>Generate a primary self-signed device certificate pair</li>
<li>Generate a secondary self-signed device certificate pair</li>
<li>Store the certificates in <code>/data/var/certificates/</code></li>
<li>Reconfigure the container descriptor in <code>/data/var/containers/manifests_dev/cloudconnector.json</code></li>
<li>Restarting the Cloud Connector container</li>
<li>Print the key fingerprints, used for onboarding the device in Azure IoT Device Provisioning Service</li>
</ul>
<h2 id="reconfiguration">Reconfiguration</h2>
<blockquote>
<p>Note: Re-running the script will only print the existing configuration.</p>
</blockquote>
<p>To reconfigure the device and use different options, perform the following steps:</p>
<ol>
<li>
<p>Delete the generated files</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>rm /data/var/certificates/azure.idscope
</span></span><span style="display:flex;"><span>rm /data/var/certificates/azure.connectionstring
</span></span><span style="display:flex;"><span>rm /data/var/certificates/device*.crt
</span></span><span style="display:flex;"><span>rm /data/var/certificates/device*.key
</span></span></code></pre></div></li>
<li>
<p>Rerun the script</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-provision
</span></span></code></pre></div></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-163a39aced07d88ca24900280481599f">5 - SDV MotD</h1>
    
	<p>The <code>sdv-motd</code> script provides an alternative motd profile, which displays some additional information after login.</p>
<p>The script does not have any command line options.</p>
<p>Example output:</p>
<p><img src="../sdv-motd.png" alt="Eclipse Leda Message Of The Day"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-51f7159b12485284fa7fa1ce5861b643">6 - CAN Forward</h1>
    
	<p>The <code>can-forward</code> help script can be used to forward an existing CAN-Bus interface on the host system to a container process.</p>
<blockquote>
<p>Note: Warning! The script does not yet support Kanto (or containerd) as a container runtime. It has been implemented for k3s.</p>
</blockquote>
<h2 id="usage">Usage</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# can-forward --help
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Usage:  /usr/bin/can-forward <span style="color:#ce5c00;font-weight:bold">{</span>-h<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">{</span>-p PID<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">{</span>-c container<span style="color:#ce5c00;font-weight:bold">}</span> &lt;hw_can&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  hw_can          Host CAN hw interface to forward. Default: can0
</span></span><span style="display:flex;"><span>  -c container    Attemmpt to get netns PID from a running container: <span style="color:#ce5c00;font-weight:bold">(</span>docker, ctr<span style="color:#ce5c00;font-weight:bold">)</span>. Default: seat_service
</span></span><span style="display:flex;"><span>  -p PID          Use provided PID <span style="color:#204a87;font-weight:bold">for</span> transferring vxcan interface <span style="color:#ce5c00;font-weight:bold">(</span>e.g.: docker inspect -f <span style="color:#4e9a06">&#39;{{ .State.Pid }}&#39;</span> container<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  -h              Prints this message
</span></span></code></pre></div><p>The script performs the following steps:</p>
<ul>
<li>Find the process ID of the target container process</li>
<li>Check and modprobe <code>vxcan</code></li>
<li>Check and modprobe <code>can-gw</code></li>
<li>Create a new virtual CAN interface (<code>vxcanX</code>)</li>
<li>Create a new virtual CAN interface (<code>vxcanX+1</code>)</li>
<li>Link both interfaces together</li>
<li>Move the second interface (<code>vxcanX+1</code>) into the namespace of the target container</li>
<li>Set up a bi-directional CAN-Bus packet forwarding between both interfaces using <code>cangw</code></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-39ff94ee053885f2bdf2856385b76f7a">7 - Kanto Auto Deployer (KAD)</h1>
    
	<p>Automatically deploys containers to the Kanto Container Management based on deployment descriptors from a given path.
All deployment descriptors in the manifests folder will be deployed (created and started) on startup of the service.
The directory will then be monitored for creation of/changes to manifests and those changes will be redeployed.</p>
<h2 id="usage">Usage</h2>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kanto-auto-deployer --help
</span></span><span style="display:flex;"><span>kanto-auto-deployer 0.2.0
</span></span><span style="display:flex;"><span>Automated deployment of Kanto Container Management Manifests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USAGE:
</span></span><span style="display:flex;"><span>    kanto-auto-deployer <span style="color:#ce5c00;font-weight:bold">[</span>OPTIONS<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>MANIFESTS_PATH<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ARGS:
</span></span><span style="display:flex;"><span>    &lt;MANIFESTS_PATH&gt;    Set the path to the directory containing the manifests <span style="color:#ce5c00;font-weight:bold">[</span>default: .<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OPTIONS:
</span></span><span style="display:flex;"><span>    -d, --daemon                   Run as a daemon that continuously monitors the provided path <span style="color:#204a87;font-weight:bold">for</span>
</span></span><span style="display:flex;"><span>                                   changes
</span></span><span style="display:flex;"><span>    -h, --help                     Print <span style="color:#204a87">help</span> information
</span></span><span style="display:flex;"><span>    -s, --socket-cm &lt;SOCKET_CM&gt;    Set the path to the Kanto Container Management API socket
</span></span><span style="display:flex;"><span>                                   <span style="color:#ce5c00;font-weight:bold">[</span>default: /run/container-management/container-management.sock<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    -V, --version                  Print version information
</span></span></code></pre></div><p>Example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Use container manifests from current working directory</span>
</span></span><span style="display:flex;"><span>root@qemux86-64:/data/var/containers/manifests# kanto-auto-deployer 
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Running initial deployment of <span style="color:#4e9a06">&#34;/data/var/containers/manifests&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Reading manifests from <span style="color:#ce5c00;font-weight:bold">[</span>/data/var/containers/manifests<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z WARN  kanto_auto_deployer::manifest_parser<span style="color:#ce5c00;font-weight:bold">]</span> Failed to load manifest directly. Will attempt auto-conversion from init-dir format.
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Already exists <span style="color:#ce5c00;font-weight:bold">[</span>cloudconnector<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z WARN  kanto_auto_deployer::manifest_parser<span style="color:#ce5c00;font-weight:bold">]</span> Failed to load manifest directly. Will attempt auto-conversion from init-dir format.
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Already exists <span style="color:#ce5c00;font-weight:bold">[</span>databroker<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Use container manifests from specified directory</span>
</span></span><span style="display:flex;"><span>root@qemux86-64:~# kanto-auto-deployer /data/var/containers/manifests/
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Running initial deployment of <span style="color:#4e9a06">&#34;/data/var/containers/manifests&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Reading manifests from <span style="color:#ce5c00;font-weight:bold">[</span>/data/var/containers/manifests<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z WARN  kanto_auto_deployer::manifest_parser<span style="color:#ce5c00;font-weight:bold">]</span> Failed to load manifest directly. Will attempt auto-conversion from init-dir format.
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Already exists <span style="color:#ce5c00;font-weight:bold">[</span>cloudconnector<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z WARN  kanto_auto_deployer::manifest_parser<span style="color:#ce5c00;font-weight:bold">]</span> Failed to load manifest directly. Will attempt auto-conversion from init-dir format.
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Already exists <span style="color:#ce5c00;font-weight:bold">[</span>databroker<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span></code></pre></div><blockquote>
<p>Nоte: The warnings from the manifest_parser module are normal and expected when the manifest is in the <a href="https://eclipse.dev/kanto/docs/references/containers/container-config/#template">Container Management Manifests Format</a></p>
</blockquote>
<h2 id="usage-as-systemd-service">Usage as systemd service</h2>
<p>In the Leda quickstart images, kanto-auto-deployer is installed as a systemd service.</p>
<blockquote>
<p>Note the service uses the <code>--daemon</code> flag that asks KAD to continuously monitor the specified directory (see last line of logs).</p>
</blockquote>
<p>The service unit configuration file is located in <code>/lib/systemd/system/kanto-auto-deployer.service</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>Unit<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">Description</span><span style="color:#ce5c00;font-weight:bold">=</span>Kanto Auto Deployer
</span></span><span style="display:flex;"><span><span style="color:#000">After</span><span style="color:#ce5c00;font-weight:bold">=</span>network-online.target container-management.service
</span></span><span style="display:flex;"><span><span style="color:#000">Wants</span><span style="color:#ce5c00;font-weight:bold">=</span>network-online.target container-management.service
</span></span><span style="display:flex;"><span><span style="color:#000">Requires</span><span style="color:#ce5c00;font-weight:bold">=</span>container-management.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>Install<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">WantedBy</span><span style="color:#ce5c00;font-weight:bold">=</span>multi-user.target
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>Service<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">Restart</span><span style="color:#ce5c00;font-weight:bold">=</span>on-failure
</span></span><span style="display:flex;"><span><span style="color:#000">RestartSec</span><span style="color:#ce5c00;font-weight:bold">=</span>5s
</span></span><span style="display:flex;"><span><span style="color:#000">ExecStart</span><span style="color:#ce5c00;font-weight:bold">=</span>/usr/bin/kanto-auto-deployer /data/var/containers/manifests --daemon
</span></span></code></pre></div><p>Example output:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:/lib/systemd/system# systemctl status kanto-auto-deployer.service 
</span></span><span style="display:flex;"><span>* kanto-auto-deployer.service - Kanto Auto Deployer
</span></span><span style="display:flex;"><span>     Loaded: loaded <span style="color:#ce5c00;font-weight:bold">(</span>/lib/systemd/system/kanto-auto-deployer.service<span style="color:#000;font-weight:bold">;</span> enabled<span style="color:#000;font-weight:bold">;</span> vendor preset: enabled<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>     Active: active <span style="color:#ce5c00;font-weight:bold">(</span>running<span style="color:#ce5c00;font-weight:bold">)</span> since Tue 2023-04-18 10:22:10 UTC<span style="color:#000;font-weight:bold">;</span> 3min 55s ago
</span></span><span style="display:flex;"><span>   Main PID: <span style="color:#0000cf;font-weight:bold">525</span> <span style="color:#ce5c00;font-weight:bold">(</span>kanto-auto-depl<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      Tasks: <span style="color:#0000cf;font-weight:bold">10</span> <span style="color:#ce5c00;font-weight:bold">(</span>limit: 4708<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>     Memory: 1.4M
</span></span><span style="display:flex;"><span>     CGroup: /system.slice/kanto-auto-deployer.service
</span></span><span style="display:flex;"><span>             <span style="color:#4e9a06">`</span>- <span style="color:#0000cf;font-weight:bold">525</span> /usr/bin/kanto-auto-deployer /data/var/containers/manifests --daemon
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:22:48 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:22:48Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Creating <span style="color:#ce5c00;font-weight:bold">[</span>sua<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:04 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:04Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Created <span style="color:#ce5c00;font-weight:bold">[</span>sua<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:04 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:04Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Starting <span style="color:#ce5c00;font-weight:bold">[</span>sua<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:05 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:05Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Started <span style="color:#ce5c00;font-weight:bold">[</span>sua<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:05 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:05Z WARN  kanto_auto_deployer::manifest_parser<span style="color:#ce5c00;font-weight:bold">]</span> Failed to load manifest directly. Will attempt auto-conversion from init-dir format.
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:05 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:05Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Creating <span style="color:#ce5c00;font-weight:bold">[</span>vum<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:10 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:10Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Created <span style="color:#ce5c00;font-weight:bold">[</span>vum<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:10 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:10Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Starting <span style="color:#ce5c00;font-weight:bold">[</span>vum<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:11 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:11Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Started <span style="color:#ce5c00;font-weight:bold">[</span>vum<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:11 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:11Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Running in daemon mode. Continuously monitoring <span style="color:#4e9a06">&#34;/data/var/containers/manifests&#34;</span>
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-67a8cb2fda94b33fb5cc6d522b276d75">8 - SDV Container Exec</h1>
    
	<p>The <code>sdv-ctr-exec</code> wrapper allows to execute arbitrary user commands in existing containers.
Kanto Container Management cli tool (<code>kanto-cm</code>) only allows to manage the lifecycle of a container,
but does not allow to specify or override the entrypoint or command definitions of an existing container.
The <code>ctr</code> command line tool of containerd allows the execution of additional <em>tasks</em> in a running container.</p>
<h2 id="usage">Usage</h2>
<p>As a convenient tool, <code>sdv-ctr-exec</code> allows the simple execution of arbitrary commands inside of containers.
This is especially useful for non-service-containers, or containers which have additional binaries (e.g. cli tools) embedded.</p>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# sdv-ctr-exec 
</span></span><span style="display:flex;"><span>/usr/bin/sdv-ctr-exec -h to print this message
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Usage:
</span></span><span style="display:flex;"><span>/usr/bin/sdv-ctr-exec &lt;container-id&gt; &lt;command&gt;
</span></span><span style="display:flex;"><span>or
</span></span><span style="display:flex;"><span>/usr/bin/sdv-ctr-exec -n &lt;container-name&gt; &lt;command&gt;
</span></span></code></pre></div><p>Example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Executing a containerized cli tool using sdv-ctr-exec</span>
</span></span><span style="display:flex;"><span>kanto-cm create --i --t --network<span style="color:#ce5c00;font-weight:bold">=</span>host --name<span style="color:#ce5c00;font-weight:bold">=</span>kuksa-client ghcr.io/eclipse/kuksa.val/kuksa-client:master
</span></span><span style="display:flex;"><span>kanto-cm start --name<span style="color:#ce5c00;font-weight:bold">=</span>kuksa-client
</span></span><span style="display:flex;"><span>sdv-ctr-exec -n kuksa-client /kuksa-client/bin/kuksa-client --port <span style="color:#0000cf;font-weight:bold">30555</span> --protocol grpc --insecure
</span></span></code></pre></div><h2 id="alternatives">Alternatives</h2>
<h3 id="containerd-ctr">containerd: <code>ctr</code></h3>
<p>The above commands are equivalent to the following commands:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Executing a containerized cli tool using ctr</span>
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm image pull ghcr.io/eclipse/kuksa.val/kuksa-client:master
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm container create --net-host --tty ghcr.io/eclipse/kuksa.val/kuksa-client:master kuksa-client
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm tasks start --detach kuksa-client
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm tasks <span style="color:#204a87">exec</span> --tty --exec-id sometask kuksa-client /kuksa-client/bin/kuksa-client --port <span style="color:#0000cf;font-weight:bold">30555</span> --protocol grpc --insecure
</span></span></code></pre></div><h3 id="containerd-nerdctl">containerd: <code>nerdctl</code></h3>
<blockquote>
<p>Note: <code>nerdctl</code> is currently not installed on the Leda Quickstart images.</p>
</blockquote>
<h3 id="containerd-ctr-and-mounting">containerd: <code>ctr</code> and mounting</h3>
<p>To execute a binary natively (outside of a containerized environment), the container image may be mounted to the host filesystem using the <code>ctr snapshots mount</code> commands.</p>
<p>This approach only works if the binary is compatible with the host environment (dependencies, libraries etc.).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">$CONTAINER_IMAGE</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;ghcr.io/my-org/my-project/my-container&#34;</span>
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm image pull <span style="color:#000">$CONTAINER_IMAGE</span>
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm container create --net-host --tty <span style="color:#000">$CONTAINER_IMAGE</span> my-container
</span></span><span style="display:flex;"><span>mkdir my-container
</span></span><span style="display:flex;"><span>ctr --namespace<span style="color:#ce5c00;font-weight:bold">=</span>kanto-cm snapshots mount my-container my-container <span style="color:#000;font-weight:bold">|</span> <span style="color:#000">$SHELL</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> my-container
</span></span><span style="display:flex;"><span>./bin/my-application --help
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-080b94ccd41bc5e866333b5c591b2719">9 - SDV Kanto-Ctl</h1>
    
	<p>Manage the Kanto Container Management configuration via CLI.</p>
<blockquote>
<p>Note: <strong>Requires</strong> <code>jq</code> to be installed.</p>
</blockquote>
<p>Features:</p>
<ul>
<li>Add and remove container registries (for authentication purposes)</li>
<li>Set primitive values in configuration</li>
<li>Restart <code>container-management.service</code> on configuration changes</li>
<li>Automatically back up configuration file</li>
<li>Display changes to user</li>
</ul>
<p><img src="../sdv-kanto-ctl-example-output1.png" alt="Eclipse Leda Kanto Container Manager Configuration utility"></p>
<h2 id="usage">Usage</h2>
<p>Synposis: <code>./sdv-kanto-ctl &lt;command&gt; [&lt;options&gt;]</code></p>
<p>Full help:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ./sdv-kanto-ctl --help
</span></span><span style="display:flex;"><span>Eclipse Kanto Container Manager Configuration Utility
</span></span><span style="display:flex;"><span>See https://eclipse.dev/kanto/docs/references/containers/container-manager-config/
</span></span><span style="display:flex;"><span>Usage: ./sdv-kanto-ctl &lt;command&gt; <span style="color:#ce5c00;font-weight:bold">{</span>options<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>Commands:
</span></span><span style="display:flex;"><span>        add-registry -h &lt;hostname&gt; -u &lt;username&gt; -p &lt;password&gt;
</span></span><span style="display:flex;"><span>                Adds or replaces a container registry authentication configuration
</span></span><span style="display:flex;"><span>                -h or --hostname: Configure the hostname of the container registry <span style="color:#ce5c00;font-weight:bold">(</span>e.g. hub.docker.io, ghcr.io, ...<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                -u or --username: Configure the username
</span></span><span style="display:flex;"><span>                -p or --password: Configure the password
</span></span><span style="display:flex;"><span>        remove-registry -h &lt;hostname&gt;
</span></span><span style="display:flex;"><span>                Removes the specified container registry
</span></span><span style="display:flex;"><span>                -h or --hostname: The hostname of the container registry
</span></span><span style="display:flex;"><span>        remove-all-registries
</span></span><span style="display:flex;"><span>                Removes all configured container registries
</span></span><span style="display:flex;"><span>        list-registries
</span></span><span style="display:flex;"><span>                Prints all configured container registries
</span></span><span style="display:flex;"><span>        show-config
</span></span><span style="display:flex;"><span>                Print the container management configuration
</span></span><span style="display:flex;"><span>        <span style="color:#204a87">set</span> &lt;key&gt; &lt;value&gt;
</span></span><span style="display:flex;"><span>                Set a primitive configuration value. Key in JSON Dot-Notation
</span></span><span style="display:flex;"><span>                Examples: ./sdv-kanto-ctl <span style="color:#204a87">set</span> containers.registry_configurations.MyRegistry.credentials.password foobar
</span></span><span style="display:flex;"><span>                          ./sdv-kanto-ctl <span style="color:#204a87">set</span> things.enable <span style="color:#204a87">true</span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>        --no-reload : Do not reload the configuration and restart the container-management service automatically
</span></span><span style="display:flex;"><span>        --ansi : Don<span style="color:#a40000">&#39;</span>t use colored output.
</span></span><span style="display:flex;"><span>        --verbose <span style="color:#000;font-weight:bold">|</span> -v : Enable verbose mode.
</span></span><span style="display:flex;"><span>        --help : This message.
</span></span></code></pre></div><h3 id="example-private-container-registries">Example: Private Container Registries</h3>
<p>To be able to pull container images, the container runtime needs access to the container registry.
Some container registries require authentication.
The Kanto Container Manager can be configured to use credentials when accessing remote container registries.</p>
<p>In the Leda images, the <em>sdv-kanto-ctl</em> tools allows to easily add authentication to the container manager configuration:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-kanto-ctl add-registry -h &lt;registryhostname&gt; -u &lt;your_username&gt; -p &lt;your_password&gt;
</span></span></code></pre></div><p>For example, to access container images from GitHub Packages in a private repository, you need a GitHub Personal Access Token (PAT) with the <code>read: packages</code> scope.
Then, add the repository as shown below:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-kanto-ctl add-registry -h ghcr.io -u github -p &lt;Your_GitHub_PersonalAccessToken&gt;
</span></span></code></pre></div><p><em>sdv-kanto-ctl</em>  will make the necessary modifications to <code>/etc/container-management/config.json</code> and restarts the <code>container-management.service</code> systemd unit,
so that the changes take effect. You may need to recreate or restart the container if a previous pull failed.</p>
<p>Please see the <a href="https://eclipse.dev/kanto/docs/references/containers/container-manager-config/">Eclipse Kanto Container Manager Configuration reference</a>
for details.</p>
<h3 id="example-enabling-things-management">Example: Enabling Things management</h3>
<p>Enable the container manager digital twin representation.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-kanto-ctl <span style="color:#204a87">set</span> things.enable <span style="color:#204a87">true</span>
</span></span></code></pre></div><h3 id="example-container-stop-timeout">Example: Container Stop Timeout</h3>
<p>Kanto waits for a timeout before forcefully stopping a container.
The default is 30 seconds in Kanto, and 10 seconds in the Leda quickstart image.</p>
<p>To change this behavior at runtime:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-kanto-ctl <span style="color:#204a87">set</span> manager.default_ctrs_stop_timeout <span style="color:#0000cf;font-weight:bold">2</span>
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-53d93802459a7c403107ddd63dfecfde">10 - Blueprint Selector</h1>
    
	<p>A Rust application that reads all blueprint files in a directory and provides the user with an
interactive (supports filtering) menu to select the one to be deployed on the edge device via MQTT.
If no directory is provided the default one on a Leda Quickstart Image is: <code>/data/var/containers/blueprints</code>.</p>
<p><img src="../blueprint-selector-1.png" alt="Screenshot"></p>
<p>The &ldquo;blueprint&rdquo; files are desired state messages, that have the extension &ldquo;.blueprint.json&rdquo; (configurable) and an additional metadata header (required):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;blueprintMetadata&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;NAME&gt;&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;&lt;Short Description&gt;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;activityId&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;correlation-id&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;timestamp&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1235466</span>
</span></span><span style="display:flex;"><span>  <span style="color:#4e9a06">&#34;payload&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{}</span> <span style="color:#8f5902;font-style:italic">// This is the desired state message
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>The metadata header will be used to construct the list of options presented to the user. You can find example blueprints under the
<code>example_blueprints</code> directory in the <a href="https://github.com/eclipse-leda/leda-utils/tree/main/src/rust/blueprint-selector/example_blueprints">leda-utils repository</a>.</p>
<p>The selected blueprint is then published as an MQTT message on the <code>vehicleupdate/desiredstate</code> topic.</p>
<h2 id="cli-options">CLI options</h2>
<p>To get all available configuration options use the <code>--help/-h</code> flag:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>A user-friendly tool to <span style="color:#204a87;font-weight:bold">select</span> and deploy SDV blueprints
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Usage: blueprint-selector <span style="color:#ce5c00;font-weight:bold">[</span>OPTIONS<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>  -d, --blueprints-dir &lt;BLUEPRINTS_DIR&gt;
</span></span><span style="display:flex;"><span>          The directory containing the SDV blueprints <span style="color:#ce5c00;font-weight:bold">[</span>default: /data/var/containers/blueprints<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>  -f, --fetch-blueprints
</span></span><span style="display:flex;"><span>          Start in fetch mode <span style="color:#ce5c00;font-weight:bold">(</span>presents a menu to fetch new/updated blueprints<span style="color:#ce5c00;font-weight:bold">)</span> from a remote repository
</span></span><span style="display:flex;"><span>  -e, --blueprints-ext &lt;BLUEPRINT_EXTENSION&gt;
</span></span><span style="display:flex;"><span>          Extension to use when iterating over the files in the blueprints directory <span style="color:#ce5c00;font-weight:bold">[</span>default: .blueprint.json<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>      --mqtt-broker-host &lt;HOST&gt;
</span></span><span style="display:flex;"><span>          Hostname/IP to the MQTT broker where the desired state message would be posted <span style="color:#ce5c00;font-weight:bold">[</span>default: 127.0.0.1<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>      --mqtt-broker-port &lt;PORT&gt;
</span></span><span style="display:flex;"><span>          Port <span style="color:#204a87;font-weight:bold">for</span> the MQTT broker <span style="color:#ce5c00;font-weight:bold">[</span>default: 1883<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>      --mqtt-topic &lt;TOPIC&gt;
</span></span><span style="display:flex;"><span>          Topic on which to publish the blueprint desired state message <span style="color:#ce5c00;font-weight:bold">[</span>default: vehicleupdate/desiredstate<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>  -h, --help
</span></span><span style="display:flex;"><span>          Print <span style="color:#204a87">help</span>
</span></span><span style="display:flex;"><span>  -V, --version
</span></span><span style="display:flex;"><span>          Print version
</span></span></code></pre></div><h2 id="normal-mode">Normal mode</h2>
<p>To run in normal mode use:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>blueprint-selector
</span></span></code></pre></div><p>or if you&rsquo;d like to provide a directory different from the default one, use:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>blueprint-selector -d &lt;/path/to/dir&gt;
</span></span></code></pre></div><h2 id="fetch-mode">Fetch mode</h2>
<p>When starting the <code>blueprint-selector</code> with the <code>-f/--fetch-blueprints</code> flag, you will be presented with a selection of different
fetchers that allow you to download/update blueprints directly in the directory specified with the <code>-d/--blueprints-dir</code> flag
(or in the default directory if not specified).
For example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>  blueprint-selector -fd &lt;/path/to/dir&gt;
</span></span></code></pre></div><p><img src="https://raw.githubusercontent.com/eclipse-leda/leda-utils/main/src/rust/blueprint-selector/images/fetcher-selection-screenshot.png" alt="Selection"></p>
<p>When you choose a fetcher, you will be asked for an URI and <code>blueprint-selector</code> will attempt to fetch the blueprints inside the directory specified by <code>-d</code>.</p>
<p>After providing a URI, pressing Enter, and a successful fetch, you will be brought back to the usual
selector menu, this time including all successfully fetched manifests.</p>
<p><img src="https://raw.githubusercontent.com/eclipse-leda/leda-utils/main/src/rust/blueprint-selector/images/fetcher_success.png" alt="Success"></p>

</div>



    
	
  



          </main>
        </div>
      </div>
      


<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/eclipse-leda" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        
        
        
          <p class="mt-2"><a href="/leda/docs/about/">About Leda</a></p>
        
      </div>
    </div>
    <div class="row">
      <div class="col-12 text-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org">
        Eclipse Foundation
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/privacy.php">
        Privacy Policy
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/termsofuse.php">
        Terms of Use
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/copyright.php">
        Copyright Agent
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/">
        Legal
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/epl-2.0/">
        License
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/security/">
        Report a Vulnerability
      </a>
    </small>
  </li>
  
</ul>

        
        
      </div>
  </div>
</footer>


    </div>
    
  <script src="/leda/js/main.min.054f118c2d3b183635f9655daee6fcebd03931cb3727d1f12fe0dda1fd784631.js" integrity="sha256-BU8RjC07GDY1&#43;WVdrub869A5Mcs3J9HxL&#43;Ddof14RjE=" crossorigin="anonymous"></script>
<script defer src="/leda/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js" integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin="anonymous"></script>
<script src='/leda/js/tabpane-persist.js'></script>

  </body>
</html>
