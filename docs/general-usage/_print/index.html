<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.110.0">
<link rel="canonical" type="text/html" href="https://eclipse-leda.github.io/leda/docs/general-usage/">
<link rel="alternate" type="application/rss&#43;xml" href="https://eclipse-leda.github.io/leda/docs/general-usage/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/leda/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/leda/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/leda/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/leda/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/leda/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/leda/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/leda/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/leda/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/leda/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/leda/favicons/android-192x192.png" sizes="192x192">

<title>Getting Started | Eclipse Leda Documentation</title>
<meta name="description" content="">
<meta property="og:title" content="Getting Started" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://eclipse-leda.github.io/leda/docs/general-usage/" />
<meta itemprop="name" content="Getting Started">
<meta itemprop="description" content=""><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Getting Started"/>
<meta name="twitter:description" content=""/>




<link rel="preload" href="/leda/scss/main.min.efaf0dc38675ce09f0ad6d5a94f95c45c40d2545a433a157a46e6b21786f9429.css" as="style">
<link href="/leda/scss/main.min.efaf0dc38675ce09f0ad6d5a94f95c45c40d2545a433a157a46e6b21786f9429.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar navbar-dark js-navbar-scroll">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/leda/"><span class="navbar-brand__logo navbar-logo"><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="30 270 300 300" id="svg2"><defs id="defs6"><clipPath id="clipPath24" clipPathUnits="userSpaceOnUse"><path id="path22" d="m5116.71 2737.03v81.36c0 51.02 13.61 71.72 55.28 74.55h288.29v-182.27c-4.26-34.29-16.73-48.19-55.28-48.19h-226.21c-47.05.0-62.08 20.69-62.08 74.55zm-139.46 17.86c0-128.41 84.19-198.71 222.24-198.71h42.8c107.43.0 184.82 2.84 217.99 84.19v-84.19h137.76v534.05c0 128.13-97.8 198.71-235.85 198.71H5051.8v-106.3h360c36 0 48.48-23.52 48.48-60.66v-122.74h-260.79c-138.05.0-222.24-70.59-222.24-198.71zm-332.5-44.22c-3.97-34.29-16.44-48.19-55-48.19h-225.07c-46.76.0-62.08 20.69-62.08 74.55v371.06c0 51.03 13.9 71.71 55.28 74.55h231.87c41.39-2.84 55-23.52 55-74.55zm139.46 854.08h-138.04v-360c-33.17 81.36-110.28 84.19-217.99 84.19h-42.8c-137.77.0-221.96-70.58-221.96-198.71v-335.34c0-128.41 84.19-198.71 221.96-198.71h42.8c107.71.0 184.82 2.84 217.99 84.19v-84.19h138.04zm-925.8-587.62h-362.83v144.85c0 28.91 12.47 60.66 48.2 60.66h266.45c35.71.0 48.18-31.75 48.18-60.66zm139.47-106.3v219.4c0 128.13-98.08 198.71-236.13 198.71h-169.51c-138.04.0-235.84-70.58-235.84-198.71v-335.34c0-128.41 97.8-198.71 235.84-198.71h405.64v106.3h-454.1c-35.73.0-48.2 23.54-48.2 60.66v147.69zM2642.92 2556.18h630.71v117.36h-483.02v794.55h-147.69z"/></clipPath><linearGradient id="linearGradient34" spreadMethod="pad" gradientTransform="matrix(2955.12,0,0,-2955.12,2642.92,3060.47)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop26" offset="0" style="stop-opacity:1;stop-color:#77add1"/><stop id="stop28" offset=".189014" style="stop-opacity:1;stop-color:#64c6ee"/><stop id="stop30" offset=".994475" style="stop-opacity:1;stop-color:#7b3199"/><stop id="stop32" offset="1" style="stop-opacity:1;stop-color:#7b3199"/></linearGradient><linearGradient id="linearGradient44" spreadMethod="pad" gradientTransform="matrix(1875.15,0,0,-1875.15,364.686,2981.28)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop38" offset="0" style="stop-opacity:1;stop-color:#7cd3c9"/><stop id="stop40" offset=".994475" style="stop-opacity:1;stop-color:#912d99"/><stop id="stop42" offset="1" style="stop-opacity:1;stop-color:#912d99"/></linearGradient><clipPath id="clipPath54" clipPathUnits="userSpaceOnUse"><path id="path52" d="m760.719 2701.88c88.719-132.65 206.929-250.3 356.031-352.34 37.13-25.23 79.65-36.85 121.32-34.58 41.39 1.98 82.49 17.85 116.79 46.77 130.11 110.26 233.01 236.97 307.27 381.26 73.14 142.01 118.49 300.76 134.36 477.63 3.97 43.66-7.65 85.61-30.89 120.2-23.81 35.43-59.53 63.49-102.9 77.95-160.16 54.42-320.88 77.38-482.74 68.03-162.43-9.35-326.269-51.31-492.659-127.28-40.821-18.7-72.285-48.75-91.281-85.04-18.704-36.28-25.508-78.52-17.29-121.89 31.75-165.26 91.848-316.06 181.989-450.71zm300.751-433.41c-159.306 109.13-286.298 235.84-382.111 378.99-97.793 145.99-162.992 308.69-197.004 486.71-12.472 65.48-1.984 130.11 26.926 185.39 28.918 55.27 76.25 101.19 137.481 128.97 177.734 81.36 353.478 126.14 527.818 136.35 174.61 9.92 347.52-14.74 519.59-73.14 64.06-21.82 117.07-63.49 152.78-116.5 35.15-52.73 53.01-116.79 47.06-183.4-17.3-189.92-66.05-360.85-144.85-513.64-79.94-155.91-191.06-292.82-331.09-411.31-51.02-43.08-112.54-66.61-175.18-69.73-62.65-3.4-126.14 13.61-181.42 51.31z"/></clipPath><linearGradient id="linearGradient70" spreadMethod="pad" gradientTransform="matrix(1417.96,0,0,-1417.96,477.178,2901.88)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop56" offset="0" style="stop-opacity:1;stop-color:#bce263"/><stop id="stop58" offset=".11811164" style="stop-opacity:1;stop-color:#bce263"/><stop id="stop60" offset=".509456" style="stop-opacity:1;stop-color:#7ab43c"/><stop id="stop62" offset=".76356415" style="stop-opacity:1;stop-color:#7ab43c"/><stop id="stop64" offset=".994475" style="stop-opacity:1;stop-color:#4e9133"/><stop id="stop66" offset=".99510668" style="stop-opacity:1;stop-color:#4e9133"/><stop id="stop68" offset="1" style="stop-opacity:1;stop-color:#4e9133"/></linearGradient><linearGradient id="linearGradient80" spreadMethod="pad" gradientTransform="matrix(942.78,0,0,-942.78,720.659,3019.8)" gradientUnits="userSpaceOnUse" y2="0" x2="1" y1="0" x1="0"><stop id="stop74" offset="0" style="stop-opacity:1;stop-color:#7cd3c9"/><stop id="stop76" offset=".994475" style="stop-opacity:1;stop-color:#912d99"/><stop id="stop78" offset="1" style="stop-opacity:1;stop-color:#912d99"/></linearGradient></defs><g transform="matrix(1.3333333,0,0,-1.3333333,0,795.04)" id="g10"><g transform="scale(0.1)" id="g12"><path id="path46" style="fill:url(#linearGradient44);fill-opacity:1;fill-rule:evenodd;stroke:none" d="m462.512 2989.03c1.133-223.65 47.902-452.13 142.867-685.13 24.66-60.94 67.465-109.13 120.187-139.47 52.727-30.61 115.657-43.93 180.852-35.14 236.122 32.03 453.262 104.03 650.552 218.55 193.89 112.53 368.79 266.17 523.27 463.18 41.11 52.15 61.8 113.67 61.8 174.9.28 61.51-20.13 123.02-60.95 175.18-145.7 186.8-317.19 337.89-515.62 450.99-194.74 110.83-415.84 185.1-665.005 220.82-65.481 9.36-128.692-3.4-181.699-33.74C665.758 3768.85 622.672 3720.94 597.441 3660c-90.14-219.4-136.062-443.06-134.929-670.97zm51.875-721.98c-99.5 244.06-148.535 484.73-149.668 721.42-1.418 241.23 47.054 477.63 142.297 708.66 33.73 81.92 91.843 146.27 163.273 187.08 71.719 40.82 156.473 58.11 244.066 45.64 261.355-37.13 494.075-115.65 699.595-232.72 209.76-119.34 390.61-278.65 544.25-475.66 54.71-70.01 81.92-152.78 81.63-235.55.0-83.06-27.49-165.83-82.2-235.56-162.42-206.65-346.68-368.5-551.62-487.27-208.35-121.05-437.67-197.02-686.549-230.75-87.313-11.9-171.785 5.95-242.934 47.05-71.433 41.39-128.976 106.02-162.14 187.66v0"/><g id="g48"><g clip-path="url(#clipPath54)" id="g50"><path id="path72" style="fill:url(#linearGradient70);fill-opacity:1;fill-rule:nonzero;stroke:none" d="m760.719 2701.88c88.719-132.65 206.929-250.3 356.031-352.34 37.13-25.23 79.65-36.85 121.32-34.58 41.39 1.98 82.49 17.85 116.79 46.77 130.11 110.26 233.01 236.97 307.27 381.26 73.14 142.01 118.49 300.76 134.36 477.63 3.97 43.66-7.65 85.61-30.89 120.2-23.81 35.43-59.53 63.49-102.9 77.95-160.16 54.42-320.88 77.38-482.74 68.03-162.43-9.35-326.269-51.31-492.659-127.28-40.821-18.7-72.285-48.75-91.281-85.04-18.704-36.28-25.508-78.52-17.29-121.89 31.75-165.26 91.848-316.06 181.989-450.71zm300.751-433.41c-159.306 109.13-286.298 235.84-382.111 378.99-97.793 145.99-162.992 308.69-197.004 486.71-12.472 65.48-1.984 130.11 26.926 185.39 28.918 55.27 76.25 101.19 137.481 128.97 177.734 81.36 353.478 126.14 527.818 136.35 174.61 9.92 347.52-14.74 519.59-73.14 64.06-21.82 117.07-63.49 152.78-116.5 35.15-52.73 53.01-116.79 47.06-183.4-17.3-189.92-66.05-360.85-144.85-513.64-79.94-155.91-191.06-292.82-331.09-411.31-51.02-43.08-112.54-66.61-175.18-69.73-62.65-3.4-126.14 13.61-181.42 51.31v0"/></g></g><path id="path82" style="fill:url(#linearGradient80);fill-opacity:1;fill-rule:evenodd;stroke:none" d="m935.898 3147.21c-54.71-85.89-93.543-185.38-115.085-298.77-4.821-24.94-1.418-49.33 9.07-69.74 10.207-20.69 27.496-37.98 49.605-48.75 97.508-46.78 197.292-73.42 300.192-78.81 101.19-5.1 205.51 9.92 312.94 46.78 23.81 8.21 42.81 23.53 55.56 42.8 12.48 19.56 18.71 43.37 16.44 68.88-9.07 108.28-36.57 208.92-83.9 301.61-46.49 91.28-111.97 175.18-197.58 251.15-18.71 16.44-41.1 25.51-63.78 26.93-22.67 1.13-45.92-5.11-66.33-19.28-88.72-61.51-161.292-135.78-217.132-222.8zM724.434 2866.87c24.093 125.28 67.461 236.12 128.976 332.78 63.211 98.93 144.563 182.27 243.5 250.87 38.83 27.21 83.9 39.11 128.12 36.56 44.22-2.55 87.31-19.84 123.03-51.59 95.24-84.47 168.37-178.01 220.25-279.78 53-104.31 84.19-217.14 94.39-337.89 3.97-47.61-8.22-92.98-32.6-130.39-24.09-37.42-60.66-66.9-105.45-82.21-119.34-41.1-236.12-57.83-349.79-51.87-115.94 6.24-228.473 36-337.325 88.44-42.805 20.41-75.398 53.29-95.242 92.98-19.848 39.68-26.648 85.6-17.859 132.1v0"/></g></g></svg></span><span class="navbar-brand__name">Eclipse Leda Documentation</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/eclipse-leda" target="_blank" rel="noopener"><span>GitHub</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/leda/offline-search-index.133e323a9b81afb22caf5b4a2b577714.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/leda/docs/general-usage/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Getting Started</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-11c17e392930b9240a7548bb725c80fd">Introduction to SDV concepts</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-1824dab7ca07fa41d55e9aa4fbba8522">Download latest release</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-c2e274f710952bd9d3ebf7604456e577">Running on Docker</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-e3267d6dbf90873c340d40fb033d58b2">Running on Raspberry Pi</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>4.1: <a href="#pg-c4637eb8366871edf0868f31752021e2">CAN-Bus extensions</a></li>


    
  

    </ul>
    
  
    
    
	
<li>5: <a href="#pg-e38cb2d9a2a02e8c844dee80c321dfc6">Running on QEMU</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>5.1: <a href="#pg-150b34f0644b4aaccf60977ee15c9b83">CAN Bus</a></li>


    
  
    
    
	
<li>5.2: <a href="#pg-901f785cd6428989692f77364554603a">Transferring Files</a></li>


    
  

    </ul>
    
  
    
    
	
<li>6: <a href="#pg-cbe51d320da57607e2f2bdd9926cee97">Running on Linux</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  
    
    
	
<li>7: <a href="#pg-2f6c44ce9348bf082b39dc70ae1a16d6">Cheatsheet</a></li>


    
  
    
    
	
<li>8: <a href="#pg-09e9389bc1ee795bba0706ccef486884">Utilities</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>8.1: <a href="#pg-3f128b6db32e0070ea241702cbec5b5a">SDV Health</a></li>


    
  
    
    
	
<li>8.2: <a href="#pg-10e59a808c83f8d618fe3bc28e3036df">KantUI</a></li>


    
  
    
    
	
<li>8.3: <a href="#pg-d9746e3a6d66da060fdb23a60b0de675">SDV Device Info</a></li>


    
  
    
    
	
<li>8.4: <a href="#pg-3c67a096a6fae106d00fcde4855f3b69">SDV Provision</a></li>


    
  
    
    
	
<li>8.5: <a href="#pg-163a39aced07d88ca24900280481599f">SDV MotD</a></li>


    
  
    
    
	
<li>8.6: <a href="#pg-51f7159b12485284fa7fa1ce5861b643">CAN Forward</a></li>


    
  
    
    
	
<li>8.7: <a href="#pg-39ff94ee053885f2bdf2856385b76f7a">Kanto Auto Deployer (KAD)</a></li>


    
  
    
    
	
<li>8.8: <a href="#pg-67a8cb2fda94b33fb5cc6d522b276d75">SDV Container Exec</a></li>


    
  
    
    
	
<li>8.9: <a href="#pg-080b94ccd41bc5e866333b5c591b2719">SDV Kanto-Ctl</a></li>


    
  

    </ul>
    
  
    
    
	
<li>9: <a href="#pg-4ba9f4b2d2c150df2117dd655ecd1818">Wifi Configuration</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>9.1: <a href="#pg-6e2aad457e20233b1a8166199667e51a">Connecting to Wi-Fi networks</a></li>


    
  

    </ul>
    
  
    
    
	
<li>10: <a href="#pg-886a90f8e9ce27e2ae5a34b321aa0a97">GPS Connectivity</a></li>


    
    <ul>
        
  
  
  
  

  

    </ul>
    
  

    </ul>


<div class="content">
        <ol>
<li>Download <a href="/leda/docs/general-usage/download-releases/">latest Eclipse Leda release</a></li>
<li>Run Eclipse Leda
<ul>
<li>on <a href="/leda/docs/general-usage/running-qemu/">emulated Qemu devices</a> or</li>
<li>on <a href="/leda/docs/general-usage/raspberry-pi/">Raspberry Pi 4</a></li>
</ul>
</li>
<li>Configure device, e.g. <a href="/leda/docs/device-provisioning/">provision the device</a></li>
<li>Explore the <a href="/leda/docs/build/misc/tools/">device tools</a></li>
<li>Develop your first Vehicle App using <a href="https://github.com/eclipse-velocitas/vehicle-app-python-template">Eclipse Velocitas template</a></li>
<li><a href="/leda/docs/app-deployment/">Deploy a Vehicle App to the device</a></li>
</ol>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-11c17e392930b9240a7548bb725c80fd">1 - Introduction to SDV concepts</h1>
    
	<p>This page introduces the main concepts around Eclipse Leda, Eclipse Kuksa, Eclipse Velocitas, and Eclipse Kanto for
developing and deploying applications for a software defined vehicle (SDV).
The intention is to introduce the main concepts and how these projects interact. When you are already familiar with the general ideas of the Eclipse SDV,
you can also jump to a hands-on tutorial on how to develop a <a href="../../app-deployment/seat-adjuster">seat adjuster application</a> or
replicate an <a href="https://github.com/eclipse-sdv-blueprints/fleet-management">Eclipse SDV Blueprint</a> for managing vehicle fleets using Eclipse SDV concepts and technologies.</p>
<h2 id="abstract-architecture">Abstract Architecture</h2>
<p>For the software defined vehicle we may assume the following abstract architecture.</p>
<p><img src="abstract-architecture.png" alt="Abstract Architecture"></p>
<p>The architecture evolves around actuators and sensors in a vehicle, like the state of a passenger seat or a door, which get controlled by connected ECUs.
These ECUs react to and produce signals, which they communicate over automotive communication systems like CAN or SOME/IP.
To establish a more flexible interaction between these ECUs and make the overall vehicle more software-defined, we assume various vehicle applications which
want to interact with the actuators and sensors, e.g., to control a seat based on a saved driver profile.
The architecture contains a vehicle abstraction layer between the ECUs and the vehicle applications.
This abstraction layer introduces a potential control point for security and safety considerations and generally decouples the application logic
from the more deeply embedded soft- and hardware layers.</p>
<h2 id="vehicle-abstraction-layer">Vehicle Abstraction Layer</h2>
<p>As the name implies the vehicle abstraction layers offers abstract ways to interact with the underlying vehicle.</p>
<h3 id="vehicle-signal-specification-vss">Vehicle Signal Specification (VSS)</h3>
<p>We need a joint data model for the potential signals with which an application can interact. We propose to use the
<a href="https://covesa.github.io/vehicle_signal_specification/introduction/overview/">Vehicle Signal Specification (VSS)</a> from
the Connected Vehicle Systems Alliance (COVESA) for this.</p>
<p><img src="vss-tree.png" alt="VSS Tree"></p>
<p>VSS essentially defines a <a href="https://covesa.github.io/vehicle_signal_specification/rule_set/">rule set</a> of how to express the definition of signals in a vehicle.
This definition bases a tree structure where each domain, like body control gets an individual sub-tree.
The authors of VSS further provide a <a href="https://github.com/COVESA/vehicle_signal_specification/tree/master/spec">default tree</a> of signals to expect in a vehicle.
However, it is common practice to tailor the default tree for a specific vehicle model by adding overlays.</p>
<p>VSS allows modeling and structuring of the data from a vehicle but does not define interfaces for the interaction with this data since this depends on the used
communication technology and further circumstances like whether VSS data gets processed inside the vehicle or off-board.</p>
<h3 id="eclipse-kuksaval-databroker">Eclipse KUKSA.val databroker</h3>
<p>For our architecture, we therefore add the <a href="https://github.com/eclipse/kuksa.val/tree/master/kuksa_databroker">Eclipse Kuksa.val databroker</a>
from the <a href="https://eclipse-kuksa.github.io/kuksa-website/">Eclipse Kuksa</a> project.</p>
<p>The Eclipse Kuksa.val databroker acts as a vehicle abstraction layer by brokering VSS signals between vehicle applications
and deeply embedded systems in the vehicle. Enabling this abstraction requires a vehicle-specific component to translate between the Kuksa.val databroker and
the underlying transport systems and ECUs.<br>
With Eclipse Kuksa, we refer to these software components as providers and further differentiate between actuation and data providers.</p>
<p><img src="kuksa-actuation.png" alt="Eclipse Kuksa Actuation"></p>
<p>For actuators, the Kuksa.val databroker stores the desired and the current state. Typically, an application would perform a control operation by setting
the target state and monitoring the current state. It is then the task of the actuation provider to perform the action while the data provider updates
the current state according to signals sent on the vehicle bus.
To get notified of any changes, applications, and providers can subscribe to specific signals at the Kuksa.val databroker.</p>
<p>The Kuksa.val databroker is written in Rust and offers communication over gRCP. To make life easier for developers using the Kuksa.val databroker there is a
<a href="https://github.com/eclipse/kuksa.val/blob/master/kuksa-client/docs/main.md">Python-client</a> which can be integrated in own applications.
When developing with other languages, you may have to generate client code yourself with the <a href="https://grpc.io/docs/languages/">gRPC tooling</a>.
Either way, these clients allow the development of vehicle applications and providers.</p>
<h2 id="vehicle-application-development">Vehicle Application Development</h2>
<p>When developing an application to interact with the abstraction layer, there are a couple of aspects to cover which are not specific to a single application.
Because of that, some projects are evolving around the application development phase.</p>
<h3 id="eclipse-autowrx-and-digitalauto-playground">Eclipse Autowrx and digital.auto Playground</h3>
<p>A good starting point to figure out what signals are available is the website of the <a href="https://digitalauto.netlify.app">digital.auto playground</a> based on Eclipse Autowrx.</p>
<p><img src="digitalauto-vehicle-api.png" alt="digital.auto Vehicle API"></p>
<p>In the next step, one can ideate on new applications, start coding, and get fast feedback using the prototyping feature of the playground.
Once one is confident with the initial version, one can continue the development journey with the help of <a href="https://eclipse.dev/velocitas/">Eclipse Velocitas</a>,
which comes with several features making the life of vehicle application developers easier.</p>
<p><img src="digitalauto-prototype.png" alt="digital.auto Prototyping"></p>
<h3 id="eclipse-velocitas">Eclipse Velocitas</h3>
<p>As a starting point, Eclipse Velocitas provides a <a href="https://github.com/eclipse-velocitas/vehicle-app-python-template">template repository</a>.
To kick-start the development of a new application, one can create an individual repository from this template.
As an alternative, Eclipse Velocitas provides a CLI application with which one can configure the creation of a tailored vehicle application repository.
Either way, the resulting repository containers <a href="https://github.com/eclipse-velocitas/vehicle-app-python-template/blob/main/app/src/main.py">skeleton code for the actual application</a>
and comes with pre-defined <a href="https://github.com/eclipse-velocitas/vehicle-app-python-template/tree/main/.github">GitHub Actions workflows</a> to automate
the testing and releasing of applications as containers.
The repository further contains the Dockerfile for a dev container that setups a development and vehicle environment on the developer machine.
It is then possible to interact with this container through VSCode.</p>
<p>Another aspect of Eclipse Velocitas is the so-called vehicle model. Here it becomes possible to take a custom vehicle model expressed in
VSS and <a href="https://github.com/eclipse-velocitas/vehicle-model-generator">generate a tailored SDK</a> with specific domain classes to interact
with a Kuksa.val databroker using the same model.
This way, one can directly develop against the used vehicle model.</p>
<p><img src="velocitas-flow.png" alt="Velocitas Flow"></p>
<!-- TODO make this text describing the picture -->
<p>A typical Eclipse Velocitas application development flow then may contain the following steps:</p>
<ul>
<li>create Repository</li>
<li>build and run Dev Container locally from VSCode</li>
<li>start vehicle runtime in Dev container</li>
<li>develop vehicle application and integration tests</li>
<li>commit and push vehicle applications to trigger tests in GitHub Actions workflows</li>
<li>trigger release workflow in GitHub</li>
</ul>
<p>As a result of the Release workflow, the generated repository contains a Container image with the vehicle application.
A target device, e.g., a vehicle or test device, can pull and execute this container.</p>
<h3 id="vehicle-providers-and-emulation">Vehicle Providers and Emulation</h3>
<p>The underlying assumption when developing a vehicle application against the vehicle abstraction layer is that components below the abstraction fulfill
the requests coming from the application. In other words: Developers have to assume that there are providers for the signals with which their application interacts.
For a production-ready vehicle, this should be the case. But during development and testing the creation of such providers adds overhead and
is a potential cause for further errors. An alternative is to use <a href="https://github.com/eclipse/kuksa.val.services">pre-developed services</a> or
even a generalized <a href="https://github.com/eclipse/kuksa.val.services/tree/main/mock_service">vehicle mock service</a> which acts as such a provider.
Developers can alter the vehicle mock service by defining the desired behavior through a Python-based DSL.</p>
<p><img src="vehicle-mock.png" alt="Vehicle Mock"></p>
<h2 id="vehicle-application-runtime">Vehicle Application Runtime</h2>
<p>The next step is to bring the application to the target device and the vehicle. There are various options for how to run and orchestrate vehicle application containers.
Some originate from general IT scenarios like Kubernetes or Docker Compose, and others focus more on automotive and IoT-use cases like <a href="https://eclipse.dev/kanto/">Eclipse Kanto</a>.
So a vehicle application developer now faces the challenge of picking a runtime and integrating this runtime with required infrastructure components like
the Kuksa.val databroker or respective Kuksa.val providers to enable the vehicle application.</p>
<h3 id="eclipse-leda">Eclipse Leda</h3>
<p>Among other things, <a href="https://eclipse-leda.github.io/leda/">Eclipse Leda</a> already provides such a target platform through a Linux-based distribution of pre-integrated Eclipse SDV components.
See the <a href="../../about/architecture/">architecture page</a> for more details on the elements in Eclipse Leda.
For the container execution, Eclipse Leda utilizes Eclipse Kanto, which implements lightweight management of OCI-compliant containers and comes by default with containerd.
It is possible to manage the containers either through a CLI or by writing container manifest files and placing them in a dedicated folder on the file system
from where Eclipse Kanto automatically performs them.</p>
<h3 id="service-exchange">Service Exchange</h3>
<p>Another challenge when deploying multiple components that need to collaborate as services is how they find and communicate with each other.
In Eclipse Kanto, the discovery and exchange can happen over container indetifiers or topics on a local MQTT broker.
The Eclipse SDV community already came up with other approaches for the service exchange topic like <a href="https://github.com/eclipse-uprotocol">Eclipse uProtocol</a>,
<a href="https://github.com/eclipse-chariott/chariott">Eclipse Chariott</a> or <a href="https://zenoh.io">Eclipse Zenoh</a>.</p>
<h2 id="seat-adjuster">Seat Adjuster</h2>
<p>To see the explained concepts in action, it is best to build your own application. The <a href="../../app-deployment/seat-adjuster">Seat Adjuster</a>
is good starting point with specific examples.</p>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1824dab7ca07fa41d55e9aa4fbba8522">2 - Download latest release</h1>
    
	<ul>
<li><a href="/leda/docs/about/releases/0.1.0/leda-0.1.0-m1/">Milestone 0.1.0-M1</a></li>
</ul>
<h2 id="latest-release-artifacts">Latest Release Artifacts</h2>
<p><strong>Note: There are no official releases yet.
The artifacts available on the Release page are for testing the build and release workflows.
They should be considered as unstable nightly builds from the main branch.
Releases marked <code>-M1</code>, <code>-M2</code>, <code>-RC1</code> etc. are preparations for official releases according to the Eclipse Release process.</strong></p>
<p>Go to the <a href="https://github.com/eclipse-leda/leda-distro/releases">Eclipse Leda Releases</a> page and download the release archive for the respective machine.
The release archives container the disk image and the respective Linux kernel:</p>
<table>
<thead>
<tr>
<th>Machine</th>
<th>Filename</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>QEMU x86_64</td>
<td>eclipse-leda-qemu-x86_64.tar.xz</td>
<td>For running QEMU x86 64-Bit</td>
</tr>
<tr>
<td>QEMU ARM 64</td>
<td>eclipse-leda-qemu-arm64.tar.xz</td>
<td>For running QEMU ARM 64-Bit</td>
</tr>
<tr>
<td>Raspberry Pi 4</td>
<td>eclipse-leda-raspberrypi.tar.xz</td>
<td>For running on Raspberry Pi 4 (SD-Card Image)</td>
</tr>
</tbody>
</table>
<h2 id="using-github-cli-tool">Using GitHub CLI tool</h2>
<p>To download all files of the latest release using the GitHub CLI:</p>
<ul>
<li>
<p>Install <a href="https://github.com/cli/cli">GitHub CLI</a>, e.g. for Ubuntu:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg <span style="color:#000;font-weight:bold">|</span> sudo dd <span style="color:#000">of</span><span style="color:#ce5c00;font-weight:bold">=</span>/usr/share/keyrings/githubcli-archive-keyring.gpg
</span></span><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;deb [arch=</span><span style="color:#204a87;font-weight:bold">$(</span>dpkg --print-architecture<span style="color:#204a87;font-weight:bold">)</span><span style="color:#4e9a06"> signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main&#34;</span> <span style="color:#000;font-weight:bold">|</span> sudo tee /etc/apt/sources.list.d/github-cli.list &gt; /dev/null
</span></span><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt install gh
</span></span></code></pre></div></li>
<li>
<p>Authenticate to GitHub:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gh auth login
</span></span></code></pre></div></li>
<li>
<p>Download Leda latest release:</p>
<p>On Linux:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mkdir leda <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#204a87">cd</span> leda
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gh release download <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>  --pattern <span style="color:#4e9a06">&#39;*.zip&#39;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>  --pattern <span style="color:#4e9a06">&#39;eclipse-leda-*&#39;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>  --repo eclipse-leda/leda-distro
</span></span></code></pre></div><p>On Windows:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gh release download --pattern <span style="color:#4e9a06">&#34;*.zip&#34;</span> --pattern <span style="color:#4e9a06">&#34;eclipse-leda-*&#34;</span> --repo eclipse-leda/leda-distro
</span></span></code></pre></div></li>
<li>
<p>Continue with <a href="/leda/docs/general-usage/running-qemu/">Running Eclipse Leda on QEMU</a> or <a href="/leda/docs/general-usage/raspberry-pi/">Running Eclipse Leda on Raspberry Pi 4</a></p>
</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c2e274f710952bd9d3ebf7604456e577">3 - Running on Docker</h1>
    
	<p>By using the dockerized Leda quickstart images, the SDV vehicle edge components can be evaluated on emulated X86-64 and ARM64 system images,
without having to install QEMU and dependencies manually.</p>
<p><img src="leda-docker-compose-up.gif" alt="Eclipse Leda Docker Compose Up"></p>
<p>If you want to execute the image without Docker, please see <a href="../running-qemu/">Running on QEMU</a>.
This allows to tweak the startup script, modify the emulated hardware device and set up advanced network configurations.</p>
<p>There are two options to run Leda:</p>
<ul>
<li>Docker: Simple, restricted to one container</li>
<li>Docker Compose: Advanced, allows networking between containers</li>
</ul>
<h2 id="recommendations">Recommendations</h2>
<ul>
<li>A <strong>Linux host</strong> with 4 vCPUs, 8GB of RAM and SSD storage is recommended</li>
<li>Docker</li>
</ul>
<h2 id="docker">Docker</h2>
<p>The easiest way is to run a single instance of Leda in a Docker container:</p>
<ul>
<li>
<p>Run the Leda Docker quickstart image:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker run -it ghcr.io/eclipse-leda/leda-distro/leda-quickstart-x86
</span></span></code></pre></div></li>
<li>
<p>Login with <code>root</code></p>
</li>
<li>
<p>Stop the Docker container</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>shutdown now
</span></span></code></pre></div><blockquote>
<p>Note: If you need to stop the container from outside, use the <code>docker stop &lt;id&gt;</code> command from a separate terminal.</p>
</blockquote>
</li>
</ul>
<h3 id="privileged-containers">Privileged Containers</h3>
<p>When run as a privileged container, QEMU will try to set up a TAP network and use KVM acceleration.
Network and CPU will be faster, depending on the host system.</p>
<p>To be able to use these host devices, QEMU needs access to the following devices:</p>
<ul>
<li><code>/dev/kvm</code></li>
<li><code>/dev/net/tun</code></li>
</ul>
<p>Example command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker run -it --privileged --device<span style="color:#ce5c00;font-weight:bold">=</span>/dev/kvm:/dev/kvm --device<span style="color:#ce5c00;font-weight:bold">=</span>/dev/net/tun:/dev/net/tun ghcr.io/eclipse-leda/leda-distro/leda-quickstart-x86
</span></span></code></pre></div><h3 id="exposing-additional-ports">Exposing additional ports</h3>
<p>To also expose ports to connect to ssh, mqtt or the Kuksa databroker, add the port mappings to the Docker command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker run -it --privileged -p 2222:2222 -p 1883:1883 -p 30555:30555 ghcr.io/eclipse-leda/leda-distro/leda-quickstart-x86:latest
</span></span></code></pre></div><p>The following ports are specifically of interest and exposed by the docker container:</p>
<ul>
<li><code>2222</code> for SSH (mapped internally to <code>22</code>)</li>
<li><code>1880</code> - free slot reserved for user service</li>
<li><code>1883</code> for MQTT</li>
<li><code>8888</code> - free slot reserved for user service</li>
<li><code>30555</code> for Kuksa Databroker</li>
</ul>
<blockquote>
<p>Note: In unprivileged mode, only these ports are mapped by the Docker container and forwarded to the Leda system.
In privileged mode, all TCP ports can be exposed, which will then be forwarded from the Docker container into the Leda system.
See the
<a href="https://github.com/eclipse-leda/leda-distro/blob/main/resources/docker-snapshot/dockerfiles/leda-quickstart-docker-entrypoint-x86.sh">entrypoint script</a>
for details.</p>
</blockquote>
<h3 id="running-arm-64-version">Running ARM-64 version</h3>
<p>To run the ARM-64 bit version of the image, use the <code>leda-quickstart-arm64</code> container image:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker run -it ghcr.io/eclipse-leda/leda-distro/leda-quickstart-arm64:latest
</span></span></code></pre></div><h2 id="docker-compose">Docker Compose</h2>
<p>A more convenient way to setup advanced scenarios is to use Docker Compose.
There is a Docker Compose configuration for an Eclipse Leda setup in <a href="https://github.com/eclipse-leda/leda-distro/tree/main/resources/docker-compose">resources/docker-compose</a>.</p>
<p>It will start up the following containers:</p>
<ul>
<li>Leda Quickstart image (QEMU x86-64)</li>
<li>Leda Quickstart image (QEMU ARM-64)</li>
<li>Web Server with pre-built RAUC Update Bundles</li>
<li>MQTT Bridge</li>
<li>DNS Proxy (Allows QEMU to use the Docker DNS)</li>
</ul>
<h3 id="usage">Usage</h3>
<p>Get the Docker Compose configuration file and additional dockerfiles from the
<a href="https://github.com/eclipse-leda/leda-distro">https://github.com/eclipse-leda/leda-distro</a> repository:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>git clone --filter<span style="color:#ce5c00;font-weight:bold">=</span>blob:none https://github.com/eclipse-leda/leda-distro
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> leda-distro/resources/docker-compose
</span></span></code></pre></div><p>Starting the containers with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker compose up --detach --wait
</span></span></code></pre></div><p>Log in to a development shell inside of the docker network:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker compose run --rm devshell
</span></span></code></pre></div><p>Stopping the containers:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker compose down
</span></span></code></pre></div><h3 id="docker-compose-services">Docker Compose Services</h3>
<p>Checking all containers are running or exited successfully:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ docker compose ps
</span></span><span style="display:flex;"><span>NAME                 COMMAND                  SERVICE              STATUS              PORTS
</span></span><span style="display:flex;"><span>leda-arm64           <span style="color:#4e9a06">&#34;/docker/leda-quicks…&#34;</span>   leda-arm64           running <span style="color:#ce5c00;font-weight:bold">(</span>healthy<span style="color:#ce5c00;font-weight:bold">)</span>   1883/tcp, 0.0.0.0:2002-&gt;2222/tcp, 0.0.0.0:30556-&gt;30555/tcp
</span></span><span style="display:flex;"><span>leda-bundle-server   <span style="color:#4e9a06">&#34;/docker-entrypoint.…&#34;</span>   leda-bundle-server   running <span style="color:#ce5c00;font-weight:bold">(</span>healthy<span style="color:#ce5c00;font-weight:bold">)</span>   0.0.0.0:8080-&gt;80/tcp
</span></span><span style="display:flex;"><span>leda-dns-proxy       <span style="color:#4e9a06">&#34;dnsmasq -k&#34;</span>             dns-proxy            running             53/tcp, 0.0.0.0:5353-&gt;53/udp
</span></span><span style="display:flex;"><span>leda-initializer     <span style="color:#4e9a06">&#34;/bin/sh -c /root/le…&#34;</span>   leda-initializer     exited <span style="color:#ce5c00;font-weight:bold">(</span>0<span style="color:#ce5c00;font-weight:bold">)</span>          
</span></span><span style="display:flex;"><span>leda-mqtt-broker     <span style="color:#4e9a06">&#34;/docker-entrypoint.…&#34;</span>   mqtt-broker          running <span style="color:#ce5c00;font-weight:bold">(</span>healthy<span style="color:#ce5c00;font-weight:bold">)</span>   0.0.0.0:1883-&gt;1883/tcp
</span></span><span style="display:flex;"><span>leda-x86             <span style="color:#4e9a06">&#34;/docker/leda-quicks…&#34;</span>   leda-x86             running <span style="color:#ce5c00;font-weight:bold">(</span>healthy<span style="color:#ce5c00;font-weight:bold">)</span>   1883/tcp, 0.0.0.0:30555-&gt;30555/tcp, 0.0.0.0:2001-&gt;2222/tcp
</span></span></code></pre></div><h3 id="network-setup">Network setup</h3>
<p>As the networking is a bit more complicated to set up with emulated network inside of QEMU, the following explanation is helpful to understand networking better.</p>
<ul>
<li>All docker compose containers are attached to a network called <code>leda-bridge</code> and <code>leda-network</code> and can see each other</li>
<li>The QEMU instances use a TAP network inside of each leda-quickstart-xxx container and do a NAT network translation to their own container</li>
<li>The Docker internal DNS server is being used. This is implemented by a DNS Proxy container,
which will forward incoming DNS requests to the Docker DNS running on the 127.0.0.x network.</li>
<li>In unprivileged mode: Only the exposed ports are forwarded from the docker container into the QEMU process:
mosquitto <code>1883</code>, ssh <code>2222</code> and kuksa.val databroker <code>30555</code>.
In privileged mode, all TCP ports are forwarded from the Docker container into the QEMU process and the special port <code>2222</code> is forwarded to ssh port.</li>
</ul>
<h3 id="developer-shell">Developer Shell</h3>
<p>Developer Shell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker compose run --rm devshell
</span></span></code></pre></div><p>From there, you can log in to either Leda on QEMU x86-64, or log in to Leda on QEMU ARM-64.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ssh leda-x86
</span></span><span style="display:flex;"><span>ssh leda-arm64
</span></span></code></pre></div><p>To run an additional terminal in the developer shell, execute this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker compose <span style="color:#204a87">exec</span> devshell /bin/bash
</span></span></code></pre></div><h3 id="interacting-with-eclipse-leda">Interacting with Eclipse Leda</h3>
<ol>
<li>Check the general system status</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-health
</span></span></code></pre></div><h3 id="device-provisioning">Device Provisioning</h3>
<ol>
<li>
<p>Run the provisioning script:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-provision
</span></span></code></pre></div></li>
<li>
<p>Copy the fingerprints</p>
</li>
<li>
<p>Go to Azure IoT Hub, create a new device</p>
</li>
<li>
<p>Use the certificate&rsquo;s common name (CN) as Device Id - on Leda, this defaults to a part of the MAC Address</p>
</li>
<li>
<p>Select <code>X.509 Self-Signed</code> authentication type and enter both fingerprints</p>
</li>
<li>
<p>Click Save</p>
</li>
</ol>
<h3 id="mqtt-broker-bridge">MQTT Broker Bridge</h3>
<div class="mermaid">  graph LR;
      A["MQTT Container <br> on docker host <br> localhost:1883"] -- Bridge --> B[leda-x86:31883];
      A -- Bridge --> C[leda-arm64:31883];
      B-->B1[mosquitto service <br> leda-x86:1883];
      C-->C1[mosquitto service <br> leda-arm64:1883];
  </div>
  
  <p>The Docker Compose setup will also start an Eclipse Mosquitto message broker as a bridge to both Leda instances.
This allows a user or developer to monitor messages sent by or received by both virtual devices.</p>
<p>Connect your MQTT client to <code>mqtt-broker.leda-network</code> by using the exposed port 1883 on the host:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mosquitto_sub -h localhost -p <span style="color:#0000cf;font-weight:bold">1883</span> -t <span style="color:#4e9a06">&#39;#&#39;</span> -v
</span></span></code></pre></div><h3 id="docker-networking">Docker Networking</h3>
<p>You need to enable IP forwarding from Docker containers to make networking work.
The containers (leda-arm64, leda-x86) need to run with <code>--privileged</code> as they change iptables rules for proper forwarding of network packets.</p>
<p>See <a href="https://docs.docker.com/network/bridge/#enable-forwarding-from-docker-containers-to-the-outside-world">Docker documentation for bridge networking</a> for details.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo sysctl net.ipv4.conf.all.forwarding<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>sudo iptables -P FORWARD ACCEPT
</span></span></code></pre></div><p>Each Eclipse Leda instance (ARM64, x86_64) is running within a QEMU emulated network (192.168.7.2), which itself is contained
in a containerized network called <code>leda-network</code> (192.168.8.x).</p>
<p>The containers wrapping the QEMU instances will forward the following ports to the respective QEMU process:</p>
<ul>
<li>SSH on port 2222</li>
<li>Mosquitto on port 1883</li>
</ul>
<h3 id="dhcp-and-dns-setup">DHCP and DNS setup</h3>
<p>Each Leda-QEMU container is running a local DHCP on the <code>tap0</code> network interface and listens for DHCP requests by the Leda Distro running inside of QEMU.
The DHCP server will respond with the same IP address (<code>192.168.7.2</code>) to the request from QEMU.</p>
<p>The DHCP response contains a DNS nameserver pointing to the <code>dns-proxy.leda-network</code> (<code>192.168.8.14</code>) IP,
which in turn forwards to Docker&rsquo;s internal <code>127.0.0.11</code> nameserver.
This allows the QEMU guests to resolve Docker Compose Services by their service name, e.g. <code>leda-bundle-server.leda-network</code>.</p>
<h3 id="volumes">Volumes</h3>
<p>The <code>/root</code> path inside of the Leda containers is mounted as a volume and contains the raw disk image and runner scripts for the QEMU Leda distribution.
Changes on the QEMU filesystem are made persistent on a copy of the QCOW2 disk image, so that restarting the device will keep any changes.</p>
<p>To reset to the original state, delete the respective docker volumes and restart the containers:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker compose down
</span></span><span style="display:flex;"><span>docker compose rm --force --stop --volumes
</span></span><span style="display:flex;"><span>docker volume rm leda-arm64
</span></span><span style="display:flex;"><span>docker volume rm leda-x86
</span></span></code></pre></div><h3 id="profiles">Profiles</h3>
<p>Profiles can be used to determine which containers (services) docker compose should be starting by default.
This is mostly used to have the <code>devshell</code> container not start up by default.</p>
<ul>
<li><code>tools</code>: Contains docker containers which are not essential at runtime, must useful for testing and development purposes</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e3267d6dbf90873c340d40fb033d58b2">4 - Running on Raspberry Pi</h1>
    
	<p>What you need:</p>
<ul>
<li>A Raspberry Pi 4B (64 Bit) with 2 GiB of RAM or more, recommended is 8 GiB</li>
<li>Network connection (Ethernet or Wifi) with transparent internet access</li>
<li>Optional keyboard and display (makes it easier to troubleshoot)</li>
</ul>
<p>Steps:</p>
<ul>
<li>
<p>Download the <a href="/leda/docs/general-usage/download-releases/">latest released SD-Card Image</a>: <code>eclipse-leda-raspberrypi.tar.xz</code></p>
</li>
<li>
<p>Uncompress the SD Card image:</p>
<pre><code>apt-get install -y xz-utils
tar xf eclipse-leda-raspberrypi.tar.xz
bzip2 -d -f sdv-image-all-raspberrypi4-64.wic.bz2
</code></pre>
</li>
<li>
<p>Flash the <code>sdv-image-all-raspberrypi4.wic</code> file to an SD-Card</p>
<ul>
<li>On Linux:
<ul>
<li>Install bmap tools: <code>sudo apt-get install -y bmap-tools</code></li>
<li>Insert SD Card and check which device is mounted: <code>sudo fdisk -l</code></li>
<li>Unmount the device: <code>sudo umount /dev/mmcblk[X]</code></li>
<li><code>sudo bmaptool copy --bmap sdv-image-all-raspberrypi4-64.wic.bmap sdv-image-all-raspberrypi4-64.wic /dev/mmcblk[X]</code></li>
<li><em>Note:  Using <code>bmap</code> is <strong>much</strong> faster but works the same as with plain <code>dd if=&lt;wic-file&gt; of=dev/mmcblk[x]</code>.</em></li>
</ul>
</li>
<li>On Windows:
<ul>
<li><a href="https://www.raspberrypi.org/documentation/installation/installing-images/">Raspberry Pi Imager</a></li>
<li><a href="https://www.balena.io/etcher/">Balena Etcher</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><em>Optional: If you need to adapt the network configuration eg Wifi credentials, edit the configuration files on the <code>boot</code> partition.</em></p>
</li>
<li>
<p>Shutdown the Raspberry and insert the SD-Card into the Raspberry Pi SD-Card slot at the bottom</p>
</li>
<li>
<p>Power on your Raspberry to boot the image</p>
</li>
<li>
<p>Login with <code>root</code></p>
</li>
<li>
<p>Check disk space:</p>
<ul>
<li>
<p>The <code>raspberry-growdisk</code> system service will do this automatically on first boot.</p>
</li>
<li>
<p>To manually enlarge the available disk space on the SD-Card, resize the disk partition: <code>parted /dev/mmcblk0 resizepart 6 100% &amp;&amp; resize2fs /dev/mmcblk0p6</code>.</p>
<p><em>Note: Due to changes in the disk partition, the partition number (<code>6</code> in the example) may have changed.</em></p>
</li>
<li>
<p>Verify with <code>df -h</code>.</p>
</li>
</ul>
</li>
<li>
<p>Verify and wait until container runtime is started: <code>systemctl status container-management</code></p>
</li>
<li>
<p><em>Optional:</em> Check the system health: <code>sdv-health</code></p>
</li>
<li>
<p>Continue with <a href="/leda/docs/device-provisioning/">Device Provisioning</a></p>
</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-c4637eb8366871edf0868f31752021e2">4.1 - CAN-Bus extensions</h1>
    
	<p>The Eclipse Leda quickstart image has CAN-Bus kernel modules and some CAN hardware drivers pre-installed.
However, some hardware configuration needs to be adapted at boot time depending on the specific CAN-Extension being attached to the device.</p>
<p>On Raspberry Pi, there is a <code>/boot/config.txt</code> file where you can configure the <code>dtoverlay</code> options accordingly.</p>
<blockquote>
<p><strong>Note:</strong> After modification, the device <strong>requires rebooting</strong> for the changes to take effect.</p>
</blockquote>
<h2 id="mcp2515-based-modules">MCP2515 based modules</h2>
<p>Products:</p>
<ul>
<li><a href="https://www.waveshare.com/rs485-can-hat.htm">Waveshare RS485 CAN HAT for Raspberry Pi</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">dtoverlay</span><span style="color:#ce5c00;font-weight:bold">=</span>mcp2515-can0,oscillator<span style="color:#ce5c00;font-weight:bold">=</span>12000000,interrupt<span style="color:#ce5c00;font-weight:bold">=</span>25,spimaxfrequency<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2000000</span>
</span></span></code></pre></div><h2 id="mcp2518fd-based-modules">MCP2518FD based modules</h2>
<p>Products:</p>
<ul>
<li><a href="https://www.waveshare.com/product/raspberry-pi/2-ch-can-fd-hat.htm">Waveshare 2-Channel Isolated CAN FD Expansion HAT for Raspberry Pi, Multi Protections</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">dtoverlay</span><span style="color:#ce5c00;font-weight:bold">=</span>2xMCP2517FD
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#dtoverlay=2xMCP2518FD-spi0</span>
</span></span></code></pre></div>
</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e38cb2d9a2a02e8c844dee80c321dfc6">5 - Running on QEMU</h1>
    
	<p>If you want to execute the image without building first, grab the latest release or build artifacts from <a href="https://github.com/eclipse-leda/leda-distro/">https://github.com/eclipse-leda/leda-distro/</a></p>
<h2 id="recommendations">Recommendations</h2>
<ul>
<li>A <strong>Linux host</strong> with 8 vCPUs, 16GB of RAM and SSD storage is recommended</li>
<li>Your Linux user should be <strong>sudoer</strong> to allow TAP network interfaces to be set up</li>
</ul>
<h2 id="qemu-x86_64">QEMU x86_64</h2>
<ul>
<li>
<p>Install <a href="https://www.qemu.org/">Qemu</a>, e.g. for Ubuntu:</p>
<pre><code>sudo apt-get update -y
sudo apt-get install -y xz-utils qemu-system-x86-64
</code></pre>
</li>
<li>
<p>Download <a href="/leda/docs/general-usage/download-releases/">latest Eclipse Leda release</a></p>
</li>
<li>
<p>Uncompress the archive</p>
<pre><code>tar xf eclipse-leda-qemu-x86_64.tar.xz
</code></pre>
</li>
<li>
<p>Run QEMU on Linux:</p>
<pre><code>./run-leda.sh
</code></pre>
</li>
<li>
<p>Run QEMU on Windows:</p>
<pre><code>run-leda.cmd
</code></pre>
<p><img src="leda-bootsequence.png" alt="Leda boot sequence"></p>
</li>
<li>
<p>Login as <code>root</code> without password on login prompt</p>
</li>
<li>
<p>Verify and wait until container runtime is started: <code>systemctl status container-management</code></p>
</li>
<li>
<p><em>Optional:</em> Check the system health: <code>sdv-health</code></p>
<p><img src="sdv-health1.png" alt="sdv-health"></p>
<p><em>Note: The status of some containers (e.g. cloud connector) are expected to stay in <strong>FAILED</strong> status as long as the <strong>Device Provisioning</strong> steps are not completed.</em></p>
</li>
<li>
<p>Continue with <a href="/leda/docs/device-provisioning/">Device Provisioning</a></p>
</li>
</ul>
<h2 id="qemu-arm-64-bit">QEMU ARM 64-Bit</h2>
<ul>
<li>
<p>Install <a href="https://www.qemu.org/">Qemu</a>, e.g. for ARM 64-Bit: <code>sudo apt install qemu-system-aarch64</code></p>
</li>
<li>
<p>Download <a href="/leda/docs/general-usage/download-releases/">latest Eclipse Leda release</a></p>
</li>
<li>
<p>Uncompress the archive</p>
<pre><code>tar xf eclipse-leda-qemu-arm64.tar.xz
</code></pre>
</li>
<li>
<p>Run QEMU on Linux:</p>
<pre><code>./run-leda.sh
</code></pre>
</li>
<li>
<p>Run QEMU on Windows:</p>
<pre><code>run-leda.cmd
</code></pre>
</li>
<li>
<p>Login as <code>root</code> without password on login prompt</p>
</li>
<li>
<p>Verify and wait until container runtime is started: <code>systemctl status container-management</code></p>
</li>
<li>
<p><em>Optional:</em> Check the system health: <code>sdv-health</code></p>
<p><em>Note: The status of some containers (e.g. cloud connector) are expected to stay in <strong>FAILED</strong> status as long as the <strong>Device Provisioning</strong> steps are not completed.</em></p>
</li>
<li>
<p>Continue with <a href="/leda/docs/device-provisioning/">Device Provisioning</a></p>
</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-150b34f0644b4aaccf60977ee15c9b83">5.1 - CAN Bus</h1>
    
	<p><em>Note: The configuration mentioned in this chapter is already enabled in the <code>run-leda.sh</code> script.</em></p>
<h2 id="qemu">QEMU</h2>
<p>General documentation about using CAN-Bus in Qemu: <a href="https://www.qemu.org/docs/master/system/devices/can.html">https://www.qemu.org/docs/master/system/devices/can.html</a></p>
<h3 id="enabling-virtual-can-bus-interfaces-vcan">Enabling Virtual CAN Bus interfaces (vcan)</h3>
<p>No special parameters are necessary for qemu, as vcan is virtual:</p>
<pre tabindex="0"><code>runqemu qemux86-64 nographic slirp qemuparams=&#34;-m 2048&#34;
</code></pre><p>Bring interface up:</p>
<pre tabindex="0"><code>ip link add dev vcan0 type vcan
ip link set vcan0 up
</code></pre><h3 id="enabling-can-bus-interfaces-can">Enabling CAN Bus interfaces (can)</h3>
<h4 id="standalone-can-within-qemu">Standalone CAN within Qemu</h4>
<p>To run a standalone CAN setup, qemu must be instructed to emulate a specific CAN hardware device. We will be using the <code>kvaser_pci</code> device in this example:</p>
<pre tabindex="0"><code>runqemu qemux86-64 nographic slirp qemuparams=&#34;-m 2048 -object can-bus,id=canbus0 -device kvaser_pci,canbus=canbus0&#34;
</code></pre><p>After the image has booted, load the Linux Kernel Module <code>kvaser_pci</code> device driver and configure the CAN-Bus device (eg bitrate) before bringing the interface up:</p>
<pre tabindex="0"><code>root@qemux86-64:~# modprobe kvaser_pci

root@qemux86-64:~# dmesg | grep kvaser
[    9.565149] kvaser_pci 0000:00:04.0: initializing device 10e8:8406
[    9.569308] kvaser_pci 0000:00:04.0: reg_base=00000000d5a68095 conf_addr=000000002b3c7ef6 irq=20
[    9.596942] kvaser_pci 0000:00:04.0: xilinx version=13 number of channels=0

root@qemux86-64:~# ip link show type can
4: can0: &lt;NOARP,ECHO&gt; mtu 16 qdisc noop state DOWN mode DEFAULT group default qlen 10
    link/can
</code></pre><p>Configure the interface:</p>
<pre tabindex="0"><code>root@qemux86-64:~# ip link set can0 type can bitrate 1000000
[  165.519919] kvaser_pci 0000:00:04.0 can0: setting BTR0=0x00 BTR1=0x14

root@qemux86-64:~# ip link set can0 up
[  186.906065] IPv6: ADDRCONF(NETDEV_CHANGE): can0: link becomes ready

root@qemux86-64:~# ip link show type can
4: can0: &lt;NOARP,UP,LOWER_UP,ECHO&gt; mtu 16 qdisc pfifo_fast state UP mode DEFAULT group default qlen 10
    link/can 
</code></pre><h4 id="tunneling-a-can-interface-from-the-host">Tunneling a CAN Interface from the Host</h4>
<pre tabindex="0"><code>runqemu qemux86-64 nographic slirp qemuparams=&#34;-m 2048 -object can-bus,id=canbus0 -object can-host-socketcan,id=canhost0,if=can0,canbus=canbus0 -device kvaser_pci,canbus=canbus0&#34;
</code></pre><p>Bring interface up:</p>
<pre tabindex="0"><code>ip link add dev can0 type can
ip link set can0 type can bitrate 1000000
ip link set can0 up
ip link show type can
</code></pre><h1 id="raspberry-pi-can-hat-extensions">Raspberry Pi CAN HAT Extensions</h1>
<p>Supported boards:</p>
<ul>
<li>Boards with a Microchip MCP251x based CAN chip, such as Waveshare CAN HAT or PiCAN 2</li>
</ul>
<p>Verify driver is loaded:</p>
<pre tabindex="0"><code># dmesg | grep mcp
[    8.23543] mcp251x spi0.0 can0: MCP2515 successfully initialized
</code></pre><p>Verify SocketCAN network interface shows up:</p>
<pre tabindex="0"><code># ip link show type can
3: can0: &lt;NOARP,ECHO&gt; mtu 16 qdisc noop state DOWN mode DEFAULT roup default qlen 10
</code></pre><p>Continue with configuring the CAN chip and bring up the SocketCAN network interface:</p>
<pre tabindex="0"><code># ip link set can0 type can bitrate 1000000
# ip link set can0 up
# ip link show type can
</code></pre><h1 id="linux-kernel-modules">Linux Kernel Modules</h1>
<p>The following Linux Kernel modules are available on the quickstart images:</p>
<p><em>Note: For QEMU, only <em>kvaser_pci</em> is used</em></p>
<h2 id="leda-main-kernel">Leda main Kernel</h2>
<ul>
<li>peak_pciefd - Socket-CAN driver for PEAK PCAN PCIe/M.2 FD family cards</li>
<li>m_can - CAN bus driver for Bosch M_CAN controller</li>
<li>m_can_pci - CAN bus driver for Bosch M_CAN controller on PCI bus</li>
<li>m_can_platform - M_CAN driver for IO Mapped Bosch controllers</li>
<li>softing - Softing DPRAM CAN driver</li>
<li>cc770_platform - Socket-CAN driver for CC770 on the platform bus</li>
<li>cc770_isa - Socket-CAN driver for CC770 on the ISA bus</li>
<li>cc770 - cc770CAN netdevice driver</li>
<li>ifi_canfd - CAN bus driver for IFI CANFD controller</li>
<li>kvaser_usb - CAN driver for Kvaser CAN/USB devices</li>
<li>etas_es58x - Socket CAN driver for ETAS ES58X USB adapters</li>
<li>ucan - Driver for Theobroma Systems UCAN devices</li>
<li>peak_usb - CAN driver for PEAK-System USB adapters</li>
<li>kvaser_pciefd - CAN driver for Kvaser CAN/PCIe devices</li>
<li>kvaser_pci - Socket-CAN driver for KVASER PCAN PCI cards</li>
<li>f81601 - Fintek F81601 PCIE to 2 CANBUS adaptor driver</li>
<li>sja1000_isa - Socket-CAN driver for SJA1000 on the ISA bus</li>
<li>plx_pci - Socket-CAN driver for PLX90xx PCI-bridge cards with the SJA1000 chips</li>
<li>sja1000 - sja1000CAN netdevice driver</li>
<li>ems_pci - Socket-CAN driver for EMS CPC-PCI/PCIe/104P CAN cards</li>
<li>peak_pci - Socket-CAN driver for PEAK PCAN PCI family cards</li>
<li>sja1000_platform - Socket-CAN driver for SJA1000 on the platform bus</li>
<li>vxcan - Virtual CAN Tunnel</li>
<li>c_can_platform - Platform CAN bus driver for Bosch C_CAN controller</li>
<li>c_can - CAN bus driver for Bosch C_CAN controller</li>
<li>c_can_pci - PCI CAN bus driver for Bosch C_CAN/D_CAN controller</li>
<li>slcan - serial line CAN interface</li>
<li>can_dev - CAN device driver interface</li>
<li>vcan - virtual CAN interface</li>
<li>can-isotop - PF_CAN isotp 15765-2:2016 protocol</li>
<li>can-gw - PF_CAN netlink gateway</li>
<li>can-j1939 - PF_CAN SAE J1939</li>
<li>can-raw - PF_CAN raw protocol</li>
<li>can-bcm - PF_CAN broadcast manager protocol</li>
<li>can - Controller Area Network PF_CAN core</li>
</ul>
<h2 id="raspberry-pi">Raspberry Pi</h2>
<p>The following Linux Kernel modules are available on the quickstart image for Raspberry Pi:</p>
<ul>
<li>can - Controller Area Network PF_CAN core</li>
<li>vxcan - Virtual CAN Tunnel</li>
<li>can-dev - CAN device driver interface</li>
<li>can-bcm - PF_CAN broadcast manager protocol</li>
<li>can-gw - PF_CAN netlink gateway</li>
<li>can-raw - PF_CAN raw protocol</li>
<li>can-isotop - PF_CAN isotp 15765-2:2016 protocol</li>
<li>can-j1939 - PF_CAN SAE J1939</li>
<li>vcan - virtual CAN interface</li>
<li>slcan - serial line CAN interface</li>
<li>mcp251x - Microchip 251x/25625 CAN driver</li>
<li>mcp251xfd - Microchip 251xFD Family CAN controller driver</li>
<li>ems_usb - CAN driver for EMS Dr. Thomas Wuensche CAN/USB interfaces</li>
<li>gs_usb - Socket CAN device driver for Geschwister Schneider UG</li>
<li>peak_usb - CAN driver for PEAK-System USB adapters</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-901f785cd6428989692f77364554603a">5.2 - Transferring Files</h1>
    
	<h1 id="sharing-a-directory-with-the-guest">Sharing a directory with the guest</h1>
<p>When you want to copy files between the host and the guest, an easy way is to use an SFTP tunnel.
With <code>sshfs</code>, you can mount a local directory to a remote directory via SSH.</p>
<h2 id="pre-requisites">Pre-Requisites</h2>
<p>Installation of needed packages:</p>
<ul>
<li>Run <code>apt-get install sshfs</code> on your host</li>
<li>Enable <code>CORE_IMAGE_EXTRA_INSTALL += &quot; openssh-sftp-server&quot;</code> in <code>local.conf</code> of your image (e.g. in the local_conf_header section in your kas file)</li>
<li>Verify SFTP connection working with <code>sftp -P 2222 root@localhost</code></li>
</ul>
<h2 id="transfering-files-from-host-to-guest">Transfering files from host to guest</h2>
<p>When you want to copy files from the host to the guest, an easy way is to use an SFTP tunnel.
With <code>sshfs</code>, you can mount a local directory to a remote directory via SSH.</p>
<ul>
<li>Create a mount point on your host: <code>mkdir remote</code></li>
<li>Open the SSH Filesystem tunnel: <code>sshfs root@localhost:/ remote/ -p 2222</code></li>
<li>Check files: <code>ls -al remote/</code> - you should see the root filesystem of the device now</li>
<li>You can now easily copy files: <code>cp foo.txt remote/home/root/</code></li>
</ul>
<h2 id="transfering-files-from-guest-to-host">Transfering files from guest to host</h2>
<p><em>Note:</em> The reverse direction, e.g. initiating an SSH tunnel from within the device to the host, is currently not supported by the installed software on the image.</p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-cbe51d320da57607e2f2bdd9926cee97">6 - Running on Linux</h1>
    
	<p>To run the main components of the SDV EDGE stack on an existing Linux distribution (e.g. Debian, Ubuntu, Raspberry Pi OS),
you need to install the following packages.</p>
<p>Please note that since this is not a full-system installation, but an additional installation, there are some differences
compared to the usual Leda installation on Docker/QEMU/Devices using our Quickstart image:</p>
<ul>
<li>The Self-Update use case is not used, as the distribution-specific channels apply.
E.g. it does not make sense to use the Leda infrastructure to flash a full system image.</li>
<li>The configuration differs slightly and you need to put some more work into getting the examples to work out of the box.
This may include different port numbers, different paths of volume mounts for containers etc.</li>
</ul>
<h2 id="debian-based-linux-distributions">Debian-based Linux distributions</h2>
<p>Tested on x86_64 via Docker:</p>
<ul>
<li>Debian 11</li>
<li>Debian 12</li>
<li>Ubuntu 20.04</li>
<li>Ubuntu 22.04</li>
<li>Ubuntu 23.10</li>
</ul>
<blockquote>
<p><em>Note:</em> Ubuntu 18.04 is not supported, as the glibc is outdated.</p>
</blockquote>
<h3 id="pre-requisuites">Pre-Requisuites</h3>
<p>The SDV stack requires the following packages to be present on the target system:</p>
<ul>
<li>
<p>Mosquitto (adapt configuration, see below)</p>
</li>
<li>
<p>Data folders</p>
<ul>
<li>
<p>Storage for Self Update Bundles: <code>mkdir -p /data/selfupdates</code></p>
</li>
<li>
<p>Device Certificates Folder:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Required by Cloud Connector</span>
</span></span><span style="display:flex;"><span>mkdir -p /data/var/certificates/
</span></span><span style="display:flex;"><span>touch /data/var/certificates/device.crt
</span></span><span style="display:flex;"><span>touch /data/var/certificates/device.key
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>systemd <em>(Optional: You can also manually start the services)</em></p>
</li>
<li>
<p>D-Bus <em>(Optional: This is for Self Update Agent to RAUC integration)</em></p>
</li>
<li>
<p>RAUC <em>(Optional: Only for Self-Update Use Case or testing purposes)</em></p>
</li>
</ul>
<h3 id="installation-steps">Installation Steps</h3>
<p><em>Note: The steps below are examples for x86 platform. If you deploy on ARM64 platform, adapt the filenames accordingly.</em></p>
<ol>
<li>
<p>Update repository and install dependencies:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>apt-get update
</span></span><span style="display:flex;"><span>apt-get -y install ca-certificates mosquitto wget
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Optional:</span>
</span></span><span style="display:flex;"><span>apt-get -y install dbus rauc
</span></span></code></pre></div></li>
<li>
<p>Download the Debian package from the <a href="https://github.com/eclipse-kanto/kanto/releases">Eclipse Kanto</a> release page</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wget <span style="color:#4e9a06">&#34;https://github.com/eclipse-kanto/kanto/releases/download/v0.1.0-M3/kanto_0.1.0-M3_linux_x86_64.deb&#34;</span>
</span></span><span style="display:flex;"><span>apt-get install -y ./kanto_0.1.0-M3_linux_x86_64.deb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Check if Kanto has been installed</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">command</span> -v container-management
</span></span><span style="display:flex;"><span><span style="color:#204a87">command</span> -v kanto-cm
</span></span><span style="display:flex;"><span>systemctl status container-management
</span></span></code></pre></div><blockquote>
<p><em>Note:</em> This will also install <code>containerd</code>.</p>
</blockquote>
</li>
<li>
<p>Download the Debian packages from the <a href="https://github.com/eclipse-leda/leda-utils/releases/">Eclipse Leda Utilities</a> release page:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wget <span style="color:#4e9a06">&#34;https://github.com/eclipse-leda/leda-utils/releases/download/v0.0.2/eclipse-leda-utils_0.0.2.0.00680_all.deb&#34;</span>
</span></span><span style="display:flex;"><span>apt-get install -y ./eclipse-leda-utils_0.0.2.0.00680_all.deb
</span></span><span style="display:flex;"><span><span style="color:#204a87">command</span> -v sdv-health
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>wget <span style="color:#4e9a06">&#34;https://github.com/eclipse-leda/leda-utils/releases/download/v0.0.2/eclipse-leda-kantui_0.0.2.0.00680_amd64.deb&#34;</span>
</span></span><span style="display:flex;"><span>apt-get install -y ./eclipse-leda-kantui_0.0.2.0.00680_amd64.deb
</span></span><span style="display:flex;"><span><span style="color:#204a87">command</span> -v kantui
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>wget <span style="color:#4e9a06">&#34;https://github.com/eclipse-leda/leda-utils/releases/download/v0.0.2/eclipse-leda-kanto-auto-deployer_0.0.2.0.00680_amd64.deb&#34;</span>
</span></span><span style="display:flex;"><span>apt-get install -y ./eclipse-leda-kanto-auto-deployer_0.0.2.0.00680_amd64.deb
</span></span><span style="display:flex;"><span><span style="color:#204a87">command</span> -v kanto-auto-deployer
</span></span></code></pre></div></li>
<li>
<p>Download the Debian package <code>eclipse-leda-container-*.deb</code> from the <a href="https://github.com/eclipse-leda/meta-leda/releases">Eclipse Meta-Leda</a> release page:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wget <span style="color:#4e9a06">&#34;https://github.com/eclipse-leda/meta-leda/releases/download/0.1.0-M2/eclipse-leda-containers_0.1.0.2.0.422_all.deb&#34;</span>
</span></span><span style="display:flex;"><span>apt-get install -y ./eclipse-leda-containers_0.1.0.2.0.422_all.deb
</span></span></code></pre></div></li>
<li>
<p>Run the <code>kanto-auto-deployer</code> to deploy the core components:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kanto-auto-deployer /var/containers/manifests
</span></span></code></pre></div><p>To install the example containers, run the following:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kanto-auto-deployer /var/containers/manifests/examples
</span></span></code></pre></div></li>
</ol>
<h3 id="configuration-hacks">Configuration Hacks</h3>
<ul>
<li>
<p>Mosquitto must be configured to allow anonymous access and listen on the network interface available to the containers. The easiest (and least secure!) configuration would be:</p>
<p><code>/etc/mosquitto/conf.d/public.conf</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plain" data-lang="plain"><span style="display:flex;"><span>listener 1883 0.0.0.0
</span></span><span style="display:flex;"><span>allow_anonymous true
</span></span></code></pre></div><blockquote>
<p><strong>Attention:</strong> Only apply this configuration on a device in a secured network, or adapt the configuration accordingly (e.g. specify internal IP address)</p>
</blockquote>
</li>
</ul>

</div>



    
      
  
  
  
  

  
  

  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2f6c44ce9348bf082b39dc70ae1a16d6">7 - Cheatsheet</h1>
    
	<p>This cheat sheet gives you an overview of common command line commands to interact with the tools available on the quickstart image.</p>
<h2 id="general-commands">General Commands</h2>
<table>
<thead>
<tr>
<th>Category</th>
<th>Task</th>
<th>Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>General</td>
<td>Overall info</td>
<td><code>sdv-health</code></td>
</tr>
<tr>
<td></td>
<td>Show device info</td>
<td><code>sdv-device-info</code></td>
</tr>
<tr>
<td></td>
<td>Device provisioning</td>
<td><code>sdv-provision</code></td>
</tr>
<tr>
<td></td>
<td>Switch Keyboard layout</td>
<td><code>loadkeys de</code></td>
</tr>
<tr>
<td>System</td>
<td>System load</td>
<td><code>htop</code></td>
</tr>
<tr>
<td></td>
<td>Disk free</td>
<td><code>df -h -t ext4</code></td>
</tr>
<tr>
<td></td>
<td>Memory free</td>
<td><code>free -h</code></td>
</tr>
<tr>
<td>Network</td>
<td>Interfaces summary</td>
<td><code>networkctl</code></td>
</tr>
<tr>
<td></td>
<td>Ethernet status</td>
<td><code>networkctl status enp0s2</code></td>
</tr>
<tr>
<td></td>
<td>Routing table</td>
<td><code>route</code></td>
</tr>
<tr>
<td></td>
<td>Active listeners</td>
<td><code>netstat -l -n -t</code></td>
</tr>
<tr>
<td></td>
<td>Multicast for Some/IP</td>
<td><code>route add -net 224.0.0.0 netmask 240.0.0.0 dev eth0</code></td>
</tr>
<tr>
<td>Kanto-CM</td>
<td>Show all containers</td>
<td><code>kanto-cm list</code></td>
</tr>
<tr>
<td></td>
<td>User interface</td>
<td><code>kantui</code></td>
</tr>
<tr>
<td></td>
<td>Service logs</td>
<td><code>journalctl -f -l -t container-management</code></td>
</tr>
<tr>
<td></td>
<td>Auto deployments</td>
<td>See <code>/data/var/containers/manifests/</code></td>
</tr>
<tr>
<td></td>
<td>Development deployments</td>
<td>See <code>/data/var/containers/manifests_dev/</code></td>
</tr>
<tr>
<td></td>
<td>Restart a container</td>
<td><code>kanto-cm restart -n &lt;containername&gt;</code></td>
</tr>
<tr>
<td></td>
<td>Manage config</td>
<td><code>sdv-kanto-ctl</code></td>
</tr>
<tr>
<td></td>
<td>Shell in container</td>
<td><code>sdv-ctr-exec &lt;containerId&gt; &lt;command&gt;</code></td>
</tr>
<tr>
<td></td>
<td>Add Private Registry</td>
<td><code>sdv-kanto-ctl add-registry -h &lt;host&gt; -u &lt;user&gt; -p &lt;pass&gt;</code></td>
</tr>
<tr>
<td>ContainerD</td>
<td>Show images</td>
<td><code>ctr --address /data/run/containerd/containerd/containerd.sock --namespace=kanto-cm i ls</code></td>
</tr>
<tr>
<td></td>
<td>Import local archive</td>
<td><code>ctr --address /data/run/containerd/containerd.sock --namespace=kanto-cm i import &lt;docker.tar&gt;</code></td>
</tr>
<tr>
<td></td>
<td>Prune containers</td>
<td><code>nerdctl system prune --all</code></td>
</tr>
<tr>
<td>Mosquitto</td>
<td>Show all messages</td>
<td><code>mosquitto_sub -v -t '#' -h localhost</code></td>
</tr>
<tr>
<td></td>
<td>Send message</td>
<td><code>mosquitto_pub -t '&lt;target/topic&gt;' -h localhost -m '{&quot;foo&quot;:&quot;bar&quot;}'</code></td>
</tr>
<tr>
<td></td>
<td>Connectivity status</td>
<td><code>mosquitto_rr --quiet -h localhost -t 'edge/thing/request' -e 'edge/thing/response' -m ''</code></td>
</tr>
<tr>
<td>RAUC Self Update</td>
<td>Current boot status</td>
<td><code>rauc status</code></td>
</tr>
<tr>
<td></td>
<td>Switch to other boot slot</td>
<td><code>rauc status mark-active other</code></td>
</tr>
<tr>
<td>CAN-Bus</td>
<td>CAN Dump</td>
<td><code>candump -l any,0:0,#FFFFFFFF</code></td>
</tr>
</tbody>
</table>
<h2 id="configuring-ntp">Configuring NTP</h2>
<p>A failed download of container images may be caused by out-of-sync clock, thus failing the TLS certificate validation.
A hardware device without hardware clock (such as the Raspberry Pi) relies on network time.
In some (corporate) networks, there might be rogue NTP servers and it might be necessary to override the NTP sources.</p>
<p>To reset NTP server to a public server, follow these steps:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Check NTP clock sync</span>
</span></span><span style="display:flex;"><span>timedatectl timesync-status
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Add your NTP server</span>
</span></span><span style="display:flex;"><span>vi /etc/systemd/timesyncd.conf
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Restart container management</span>
</span></span><span style="display:flex;"><span>systemctl restart container-management
</span></span><span style="display:flex;"><span>systemctl restart kanto-auto-deployer
</span></span></code></pre></div><h2 id="reset-container-deployment">Reset container deployment</h2>
<p>When things go really wrong and the container runtime is unable deploy containers properly, it may be necessary to reset the internal state.
This is achieved by stopping the container runtime(s) and deleting the <code>/var/lib/container-management</code> folder:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Stop all container runtimes</span>
</span></span><span style="display:flex;"><span>systemctl stop container-management 
</span></span><span style="display:flex;"><span>systemctl stop containerd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Delete the persistence of container management</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Attention! Here be dragons</span>
</span></span><span style="display:flex;"><span>rm -rf /var/lib/container-management
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Restart the container runtimes</span>
</span></span><span style="display:flex;"><span>systemctl start containerd
</span></span><span style="display:flex;"><span>systemctl start container-management
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Redeploy the containers</span>
</span></span><span style="display:flex;"><span>systemctl restart kanto-auto-deployer
</span></span></code></pre></div><h2 id="running-custom-ad-hoc-containers">Running custom ad-hoc containers</h2>
<p>To install arbitrary containers, create the container using the <code>kanto-cm</code> command line tool.
If it&rsquo;s not a background service, but a cli tool, adding the <code>--t --i</code> options allows console access.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# kanto-cm remove --name python
</span></span><span style="display:flex;"><span>root@qemux86-64:~# kanto-cm create --name python --t --i --privileged docker.io/library/python:3.8.16-slim-bullseye
</span></span><span style="display:flex;"><span>bf9deca4-dbf1-4132-9ba7-e0f378bd34a7
</span></span><span style="display:flex;"><span>root@qemux86-64:~# kanto-cm start --name python --a --i
</span></span><span style="display:flex;"><span>Python 3.8.16 <span style="color:#ce5c00;font-weight:bold">(</span>default, Jan <span style="color:#0000cf;font-weight:bold">24</span> 2023, 00:19:05<span style="color:#ce5c00;font-weight:bold">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>GCC 10.2.1 20210110<span style="color:#ce5c00;font-weight:bold">]</span> on linux
</span></span><span style="display:flex;"><span>Type <span style="color:#4e9a06">&#34;help&#34;</span>, <span style="color:#4e9a06">&#34;copyright&#34;</span>, <span style="color:#4e9a06">&#34;credits&#34;</span> or <span style="color:#4e9a06">&#34;license&#34;</span> <span style="color:#204a87;font-weight:bold">for</span> more information.
</span></span><span style="display:flex;"><span>&gt;&gt;&gt; quit<span style="color:#ce5c00;font-weight:bold">()</span>
</span></span></code></pre></div><h2 id="raspberry-pi-overlays">Raspberry Pi Overlays</h2>
<p>Edit <code>/boot/config.txt</code> and reboot:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plain" data-lang="plain"><span style="display:flex;"><span># Disable to fix non-working standard Raspberry Pi 7&#34; display
</span></span><span style="display:flex;"><span># dtoverlay=vc4-kms-v3d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># PiCAN 2
</span></span><span style="display:flex;"><span># dtoverlay=mcp2515-can0,oscillator=16000000,interrupt=25
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Waveshare RS485 CAN Hat
</span></span><span style="display:flex;"><span># dtoverlay=mcp2515-can0,oscillator=12000000,interrupt=25,spimaxfrequency=2000000
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-09e9389bc1ee795bba0706ccef486884">8 - Utilities</h1>
    
	<p>The quickstart image contains the following utilities.
These utility scripts are meant to be convenience tools for users and developers.
They help to experiment with the container deployment, device provisioning or vehicle data access.</p>
<ul>
<li><strong>sdv-health:</strong> Show SDV software components health status</li>
<li><strong>kantui:</strong> A text user interface for kanto-cm to manage containers (start, stop, logs, redeploy all)</li>
<li><strong>sdv-device-info:</strong> Show and update device information</li>
<li><strong>sdv-provision:</strong> Generate device certificates and configuration of cloud connection</li>
<li><strong>sdv-motd:</strong> Message-of-the-Day shown after login prompt</li>
<li><strong>can-forward:</strong> Forwarding a CAN-bus network interface into a containerized Vehicle Application</li>
<li><strong>kanto-auto-deployer:</strong> Automatically deploys containers on boot. Runs as a systemd service, and can also be invoked by a user directly.</li>
<li><strong>sdv-ctr-exec:</strong> Execute arbitrary commands in existing containers</li>
<li><strong>sdv-kanto-ctl:</strong> Manage the Kanto Container Management configuration via CLI</li>
</ul>
<blockquote>
<p>Note:
These scripts are not meant to be reused or called from production software.
Their behaviour or command line syntax is not a stable API and should not be trusted for automation purposes.
For details, please see <a href="https://github.com/eclipse-leda/leda-utils/">leda-utils</a></p>
</blockquote>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3f128b6db32e0070ea241702cbec5b5a">8.1 - SDV Health</h1>
    
	<h2 id="health-check">Health check</h2>
<p>The sdv-health utility displays a status overview of some important dependencies and device configurations for the SDV edge stack.
The sdv health utility can be configured using the sdv.conf configuration file.</p>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># sdv-health</span>
</span></span></code></pre></div><p>Example output:</p>
<p><img src="../sdv-health-output.png" alt="SDV Health Example Output"></p>
<h3 id="version-information">Version Information</h3>
<p>The Leda image version and build time will be displayed at the top in the first category:</p>
<ul>
<li>OS Release: Year and codename of the release version</li>
<li>Image Version: Name of the image and more specific version information, such as the git tag or commit id</li>
<li>Build timestamp in <code>yyyMMddHHmmss</code> notation</li>
</ul>
<blockquote>
<p>Note: The information is read from the system base file in <code>/etc/os-release</code>:</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# cat /etc/os-release 
</span></span><span style="display:flex;"><span><span style="color:#000">BUILD_ID</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;20230309083051&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">DISTRO_CODENAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Dracon&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">ID</span><span style="color:#ce5c00;font-weight:bold">=</span>leda
</span></span><span style="display:flex;"><span><span style="color:#000">IMAGE_VERSION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;0.0.5-41-g82f2b12&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">NAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Eclipse Leda&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">PRETTY_NAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Eclipse Leda 2023 (Dracon)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">VERSION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;2023 (Dracon)&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">VERSION_CODENAME</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;Dracon&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">VERSION_ID</span><span style="color:#ce5c00;font-weight:bold">=</span>0.0.5-41-g82f2b12
</span></span></code></pre></div><h3 id="bus-networks">Bus networks</h3>
<p>If available, vehicle bus network information, such as the status of the CAN-Bus, will be displayed iin its own category.
This helps to quickly identify if there problems with the hardware connectivity for automotive bus networks.</p>
<h3 id="ports">Ports</h3>
<p>The health utility checks the TCP ports of specific services.
This helps to identify if these services are up and running and potentiallyconnectable via external network interfaces.</p>
<h3 id="services-and-containers">Services and Containers</h3>
<p>The services category shows the status of required and optional containers.
The required containers are supposed to be up and running for the SDV.EDGE stack to be correctly up and running.
If any of these core components have a failed state, the functionality is impacted.</p>
<p>The optional containers are for additional features and for example applications.
These containers may not be necessary for each use case and hence will be marked as a warning if they are not up and running.
The overview still helps to identify which containers are working properly.</p>
<h3 id="errors-warnings-failed-states">Errors, Warnings, Failed states</h3>
<p>When there are errors or warnings related to the status of SDV related components,
the health utility will print out these error states, and if available also a more detailed error message.</p>
<p>In the following example, the health utility helps the troubleshooting process:</p>
<ul>
<li>The container runtime is properly started: &ldquo;Kanto CM&rdquo; is OK in the &ldquo;SDV Ports&rdquo; section and the &ldquo;container-management&rdquo; service is OK in the &ldquo;SDV Services&rdquo; section&quot;.</li>
<li>Some containers are in state &ldquo;OK&rdquo;, which means there is no general issue with the container runtime.</li>
<li>The cloud connector is in a &ldquo;Stopped&rdquo; state, which indicates that the user manually stopped the container by using &ldquo;kanto-cm stop -n cloud-connector&rdquo;.</li>
<li>The sua container is in a &ldquo;Exited&rdquo; state, which indicates the process exited with an error code.</li>
</ul>
<p><img src="../sdv-health-example-errors2.png" alt="SDV Health Example Errors"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-10e59a808c83f8d618fe3bc28e3036df">8.2 - KantUI</h1>
    
	<p>The KantoUI tool is a text-based user interface for conveniently managing containers in the Kanto Container Management.
It supports simple navigation using keyboard and mouse to select a specific container.
Commands to start, stop, remove and re-deploy containers are available along with a functionality to retrieve the application logs of a selected container.</p>
<h2 id="kanto-user-interface">Kanto User Interface</h2>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kantui
</span></span></code></pre></div><p>Example output:</p>
<p><img src="../kantui-large.png" alt="KantoUI"></p>
<h2 id="command-line-options">Command Line Options</h2>
<p>Print command line help:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# kantui --help
</span></span><span style="display:flex;"><span>kantui 0.2.0
</span></span><span style="display:flex;"><span>A TUI <span style="color:#204a87;font-weight:bold">for</span> Kanto CM that allows easier management of deployed containers. Requires root.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USAGE:
</span></span><span style="display:flex;"><span>    kantui <span style="color:#ce5c00;font-weight:bold">[</span>OPTIONS<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OPTIONS:
</span></span><span style="display:flex;"><span>    -c, --config-file-path &lt;CONFIG_FILE_PATH&gt;
</span></span><span style="display:flex;"><span>            Set a custom path <span style="color:#204a87;font-weight:bold">for</span> the kantui configuration file <span style="color:#ce5c00;font-weight:bold">[</span>default:
</span></span><span style="display:flex;"><span>            /etc/kantui/kantui_conf.toml<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    -h, --help
</span></span><span style="display:flex;"><span>            Print <span style="color:#204a87">help</span> information
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    -V, --version
</span></span><span style="display:flex;"><span>            Print version information
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Note: All config values can be overridden through env variables prefixed with KANTUI_,
</span></span><span style="display:flex;"><span>e.g. <span style="color:#000">KANTUI_STOP_TIMEOUT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">5</span> overrides the timeout before SIGKILL is sent to be <span style="color:#0000cf;font-weight:bold">5</span> seconds.
</span></span></code></pre></div><h2 id="keyboard-commands">Keyboard commands</h2>
<ul>
<li>Arrow keys <code>Up</code> and <code>Down</code> to select a container</li>
<li>Arrow keys <code>Left</code> and <code>Right</code> to select a column</li>
<li><code>Enter</code> to change the sort ordering of the currently selected column</li>
<li><code>S</code> to <strong>start</strong> the selected container which is currently not running</li>
<li><code>P</code> to <strong>stop</strong> the selected container</li>
<li><code>R</code> to <strong>remove</strong> a container</li>
<li><code>L</code> to show the <strong>log output</strong> of a container</li>
<li><code>D</code> to redeploy an existing container (rereads deployment descriptor)</li>
<li><code>Q</code> to <strong>quit</strong> kantui</li>
</ul>
<blockquote>
<p>Note: The mouse can be used to select ui items when holding the <code>Shift</code> key.</p>
</blockquote>
<h2 id="starting-stopping-removing-containers">Starting, Stopping, Removing containers</h2>
<p>To use the lifecycle commands on a container:</p>
<ol>
<li>Select a container by using the mouse or the arrow keys.</li>
<li>The selected container is highlighted.</li>
<li>Press one of the lifecycle commands, e.g. <code>s</code>, <code>p</code> or <code>r</code></li>
<li>Wait for the value in the <em>State</em> column to change, before issueing the next command.</li>
</ol>
<blockquote>
<p>Note: When using the lifecycle commands for containers (Start, Stop, Remove), it may take a few seconds before the UI is updated with the status changes.
The amount of time before a container is forcefully killed is determined by the <code>stop_timeout</code> configuration option.</p>
</blockquote>
<h2 id="show-container-logs">Show container Logs</h2>
<p>To view the container&rsquo;s log output:</p>
<ol>
<li>Select a container by using the mouse or the arrow keys.</li>
<li>Press the <code>L</code> key</li>
<li>Log output will be displayed (tail, oldest messages first)</li>
<li>Use the arrow keys <code>Up</code> and <code>Down</code> or drag the scrollbar using your mouse to scroll through the log</li>
<li>Close the Log viewer by pressing <code>Enter</code> or clicking on the <code>OK</code> button</li>
</ol>
<blockquote>
<p>Note: The log output is <strong>not followed</strong> automatically. Close the dialog and reopen to see new output.</p>
</blockquote>
<h2 id="redeploying-containers">Redeploying containers</h2>
<p>To redeploy a container, e.g. when a deployment descriptor has changed on disk:</p>
<ol>
<li>Select a container by using the mouse or the arrow keys.</li>
<li>Press the <code>P</code> key to stop the container</li>
<li>Press the <code>R</code> key to remove the container</li>
<li>Press the <code>D</code> key to invoke the Kanto Auto Deployer, which will redeploy the missing containers</li>
</ol>
<blockquote>
<p>Note: Only containers managed by Kanto Auto Deployer will be redeployed.</p>
</blockquote>
<h2 id="column-sorting">Column Sorting</h2>
<p>To sort a column:</p>
<ol>
<li>Select the column using the <code>Left</code> and <code>Right</code> arrow keys</li>
<li>Press <code>Enter</code> to activate sorting</li>
<li>Press <code>Enter</code> again on a sorted column to invert sort order (Ascending -&gt; Descending -&gt; Ascending)</li>
</ol>
<blockquote>
<p>Note: The selected sort order is not persisted and will reset to the default on restart: By <code>ID</code>, ascending</p>
</blockquote>
<h2 id="configuration-file">Configuration File</h2>
<p>The default location of the configuration file is <code>/etc/kantui/kantui_conf.toml</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># General Configuration Options</span>
</span></span><span style="display:flex;"><span><span style="color:#000">socket_path</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;/run/container-management/container-management.sock&#34;</span> <span style="color:#8f5902;font-style:italic"># Path to kanto-cm unix socket</span>
</span></span><span style="display:flex;"><span><span style="color:#000">stop_timeout</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#8f5902;font-style:italic"># timeout (integer) in seconds before a SIGKILL is sent after a SIGTERM</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>keyconfig<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">start_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;[S]tart&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">start_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;s&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">stop_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Sto[P]&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">stop_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;p&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">remove_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;[R]emove&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">remove_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;r&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">logs_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;[L]ogs&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">logs_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;l&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">quit_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;[Q]uit&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">quit_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;q&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">redeploy_btn_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Re[D]eploy&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">redeploy_kbd_key</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;d&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Includes a shell lexer so anything that would be a valid shell command can be used</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># No pipes/redirects allowed.</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># N.B.: Command inherits kantui&#39;s privileges (root)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">redeploy_command</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;systemctl restart kanto-auto-deployer.service&#34;</span>
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d9746e3a6d66da060fdb23a60b0de675">8.3 - SDV Device Info</h1>
    
	<p>Displays the current device configuration, such as Device ID.</p>
<blockquote>
<p>Note: <strong>Requires</strong> the <em>Cloud Connector</em> component to be configured and running.</p>
</blockquote>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-device-info
</span></span></code></pre></div><p><img src="../sdv-device-info-example-output1.png" alt="Eclipse Leda Device Info Example Output"></p>
<h2 id="usage">Usage</h2>
<p>Synposis: <code>./sdv-device-info [options] [command]</code></p>
<p>Full help:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# sdv-device-info --help
</span></span><span style="display:flex;"><span>sdv-device-info v0.2
</span></span><span style="display:flex;"><span>Usage: /usr/bin/sdv-device-info <span style="color:#ce5c00;font-weight:bold">[</span>options<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>command<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Show SDV device configuration information
</span></span><span style="display:flex;"><span>Example: /usr/bin/sdv-device-info show
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Commands:
</span></span><span style="display:flex;"><span> show                 : Display configuration <span style="color:#ce5c00;font-weight:bold">(</span>default <span style="color:#204a87">command</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span> <span style="color:#204a87">help</span>                 : This message
</span></span><span style="display:flex;"><span> env                  : Format output <span style="color:#204a87;font-weight:bold">for</span> use in scripts
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span> --ansi <span style="color:#000;font-weight:bold">|</span> -a      : Don<span style="color:#a40000">&#39;</span>t use colored output.
</span></span><span style="display:flex;"><span> --norestart <span style="color:#000;font-weight:bold">|</span> -n : Do not automatically restart services
</span></span><span style="display:flex;"><span> --verbose <span style="color:#000;font-weight:bold">|</span> -v   : Enable verbose mode.
</span></span><span style="display:flex;"><span> --help <span style="color:#000;font-weight:bold">|</span> -h      : This message.
</span></span></code></pre></div><h2 id="use-in-scripts">Use in scripts</h2>
<p>To use device information on other scripts, it may be useful to source the device information variables into the current environment variable context:</p>
<p>Synposis: <code>source ./sdv-device-info env</code></p>
<p>Example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ <span style="color:#204a87">source</span> ./sdv-device-info env
</span></span><span style="display:flex;"><span>$ <span style="color:#204a87">echo</span> <span style="color:#000">$DEVICE_ID</span>
</span></span><span style="display:flex;"><span>exampledevice1
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3c67a096a6fae106d00fcde4855f3b69">8.4 - SDV Provision</h1>
    
	<p>The provisioning helper script can be used to manually perform a device provisioning with a cloud backend.</p>
<p>It is meant as a convenient tool for developers, who wish to connect their device to a selfmanaged cloud backend directly.
In a production environment, the device provisioning functionality is implemented either by the <em>Cloud Connector</em> component.</p>
<p>The provisioning script currently supports the following backend and authentication options:</p>
<ul>
<li>Azure IoT Hub
<ul>
<li>Connection String</li>
<li>Device Certificates</li>
</ul>
</li>
<li>Azure IoT Device Provisioning Service
<ul>
<li>Device Certificates</li>
</ul>
</li>
</ul>
<h2 id="usage">Usage</h2>
<p>The <em>sdv-provision</em> script is interactive and asks for the type of backend and authentication option:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# sdv-provision 
</span></span><span style="display:flex;"><span>Checking Eclipse Leda Device Provisioning configuration...
</span></span><span style="display:flex;"><span>- Certificates directory exists
</span></span><span style="display:flex;"><span>Checking Device ID
</span></span><span style="display:flex;"><span>- Based on network device: eth0
</span></span><span style="display:flex;"><span>- Device ID: 52-54-21-4c-f9-5a
</span></span><span style="display:flex;"><span>Checking whether either IdScope or ConnectionString is configured
</span></span><span style="display:flex;"><span> - Neither Id Scope file nor ConnectionString found, needs manual configuration
</span></span><span style="display:flex;"><span>Do you want to use the global Azure IoT Device Provisioning Service <span style="color:#ce5c00;font-weight:bold">(</span>DPS<span style="color:#ce5c00;font-weight:bold">)</span> by using an Id Scope, or <span style="color:#204a87;font-weight:bold">do</span> you want to use a direct connection to a specific Azure IoT Hub using a Connection String?
</span></span><span style="display:flex;"><span>d<span style="color:#ce5c00;font-weight:bold">)</span> Azure IoT Device Provisioning Service <span style="color:#ce5c00;font-weight:bold">(</span>DPS<span style="color:#ce5c00;font-weight:bold">)</span> with Id Scope
</span></span><span style="display:flex;"><span>h<span style="color:#ce5c00;font-weight:bold">)</span> Azure IoT Hub with Connection String
</span></span><span style="display:flex;"><span>Choose:d
</span></span><span style="display:flex;"><span>Please enter your Id Scope of the Azure IoT Device Provisioning Service:example
</span></span><span style="display:flex;"><span>Recreating the Cloud Connector container...
</span></span><span style="display:flex;"><span>Checking device certificates
</span></span><span style="display:flex;"><span>- All device certificates are present
</span></span><span style="display:flex;"><span>- Primary device certificate: /data/var/certificates/device.crt
</span></span><span style="display:flex;"><span>- Primary device private key: /data/var/certificates/device.key
</span></span><span style="display:flex;"><span>- Secondary device certificate: /data/var/certificates/device2.crt
</span></span><span style="display:flex;"><span>- Secondary device private key: /data/var/certificates/device2.key
</span></span><span style="display:flex;"><span>Fingerprints <span style="color:#ce5c00;font-weight:bold">(</span>add these to the Azure IoT Hub Device<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>- Primary thumbprint: 1B172ED3D06F4E25AFFEF675ADCE519457FFFFFF
</span></span><span style="display:flex;"><span>- Secondary thumbprint: B6CD5EACE96E9D0448BCB0BAED2DEE87AFFFFFFF
</span></span></code></pre></div><p>Once a configuration has been selected, the script will:</p>
<ul>
<li>Generate a random Device Id (based on physical network address)</li>
<li>Store the Device Id in <code>/etc/deviceid</code></li>
<li>Generate a primary self-signed device certificate pair</li>
<li>Generate a secondary self-signed device certificate pair</li>
<li>Store the certificates in <code>/data/var/certificates/</code></li>
<li>Reconfigure the container descriptor in <code>/data/var/containers/manifests_dev/cloudconnector.json</code></li>
<li>Restarting the Cloud Connector container</li>
<li>Print the key fingerprints, used for onboarding the device in Azure IoT Device Provisioning Service</li>
</ul>
<h2 id="reconfiguration">Reconfiguration</h2>
<blockquote>
<p>Note: Re-running the script will only print the existing configuration.</p>
</blockquote>
<p>To reconfigure the device and use different options, perform the following steps:</p>
<ol>
<li>
<p>Delete the generated files</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>rm /data/var/certificates/azure.idscope
</span></span><span style="display:flex;"><span>rm /data/var/certificates/azure.connectionstring
</span></span><span style="display:flex;"><span>rm /data/var/certificates/device*.crt
</span></span><span style="display:flex;"><span>rm /data/var/certificates/device*.key
</span></span></code></pre></div></li>
<li>
<p>Rerun the script</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-provision
</span></span></code></pre></div></li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-163a39aced07d88ca24900280481599f">8.5 - SDV MotD</h1>
    
	<p>The <code>sdv-motd</code> script provides an alternative motd profile, which displays some additional information after login.</p>
<p>The script does not have any command line options.</p>
<p>Example output:</p>
<p><img src="../sdv-motd.png" alt="Eclipse Leda Message Of The Day"></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-51f7159b12485284fa7fa1ce5861b643">8.6 - CAN Forward</h1>
    
	<p>The <code>can-forward</code> help script can be used to forward an existing CAN-Bus interface on the host system to a container process.</p>
<blockquote>
<p>Note: Warning! The script does not yet support Kanto (or containerd) as a container runtime. It has been implemented for k3s.</p>
</blockquote>
<h2 id="usage">Usage</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# can-forward --help
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Usage:  /usr/bin/can-forward <span style="color:#ce5c00;font-weight:bold">{</span>-h<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">{</span>-p PID<span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">{</span>-c container<span style="color:#ce5c00;font-weight:bold">}</span> &lt;hw_can&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  hw_can          Host CAN hw interface to forward. Default: can0
</span></span><span style="display:flex;"><span>  -c container    Attemmpt to get netns PID from a running container: <span style="color:#ce5c00;font-weight:bold">(</span>docker, ctr<span style="color:#ce5c00;font-weight:bold">)</span>. Default: seat_service
</span></span><span style="display:flex;"><span>  -p PID          Use provided PID <span style="color:#204a87;font-weight:bold">for</span> transferring vxcan interface <span style="color:#ce5c00;font-weight:bold">(</span>e.g.: docker inspect -f <span style="color:#4e9a06">&#39;{{ .State.Pid }}&#39;</span> container<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>  -h              Prints this message
</span></span></code></pre></div><p>The script performs the following steps:</p>
<ul>
<li>Find the process ID of the target container process</li>
<li>Check and modprobe <code>vxcan</code></li>
<li>Check and modprobe <code>can-gw</code></li>
<li>Create a new virtual CAN interface (<code>vxcanX</code>)</li>
<li>Create a new virtual CAN interface (<code>vxcanX+1</code>)</li>
<li>Link both interfaces together</li>
<li>Move the second interface (<code>vxcanX+1</code>) into the namespace of the target container</li>
<li>Set up a bi-directional CAN-Bus packet forwarding between both interfaces using <code>cangw</code></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-39ff94ee053885f2bdf2856385b76f7a">8.7 - Kanto Auto Deployer (KAD)</h1>
    
	<p>Automatically deploys containers to the Kanto Container Management based on deployment descriptors from a given path.
All deployment descriptors in the manifests folder will be deployed (created and started) on startup of the service.
The directory will then be monitored for creation of/changes to manifests and those changes will be redeployed.</p>
<h2 id="usage">Usage</h2>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ kanto-auto-deployer --help
</span></span><span style="display:flex;"><span>kanto-auto-deployer 0.2.0
</span></span><span style="display:flex;"><span>Automated deployment of Kanto Container Management Manifests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>USAGE:
</span></span><span style="display:flex;"><span>    kanto-auto-deployer <span style="color:#ce5c00;font-weight:bold">[</span>OPTIONS<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">[</span>MANIFESTS_PATH<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ARGS:
</span></span><span style="display:flex;"><span>    &lt;MANIFESTS_PATH&gt;    Set the path to the directory containing the manifests <span style="color:#ce5c00;font-weight:bold">[</span>default: .<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OPTIONS:
</span></span><span style="display:flex;"><span>    -d, --daemon                   Run as a daemon that continuously monitors the provided path <span style="color:#204a87;font-weight:bold">for</span>
</span></span><span style="display:flex;"><span>                                   changes
</span></span><span style="display:flex;"><span>    -h, --help                     Print <span style="color:#204a87">help</span> information
</span></span><span style="display:flex;"><span>    -s, --socket-cm &lt;SOCKET_CM&gt;    Set the path to the Kanto Container Management API socket
</span></span><span style="display:flex;"><span>                                   <span style="color:#ce5c00;font-weight:bold">[</span>default: /run/container-management/container-management.sock<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    -V, --version                  Print version information
</span></span></code></pre></div><p>Example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Use container manifests from current working directory</span>
</span></span><span style="display:flex;"><span>root@qemux86-64:/data/var/containers/manifests# kanto-auto-deployer 
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Running initial deployment of <span style="color:#4e9a06">&#34;/data/var/containers/manifests&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Reading manifests from <span style="color:#ce5c00;font-weight:bold">[</span>/data/var/containers/manifests<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z WARN  kanto_auto_deployer::manifest_parser<span style="color:#ce5c00;font-weight:bold">]</span> Failed to load manifest directly. Will attempt auto-conversion from init-dir format.
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Already exists <span style="color:#ce5c00;font-weight:bold">[</span>cloudconnector<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z WARN  kanto_auto_deployer::manifest_parser<span style="color:#ce5c00;font-weight:bold">]</span> Failed to load manifest directly. Will attempt auto-conversion from init-dir format.
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:21Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Already exists <span style="color:#ce5c00;font-weight:bold">[</span>databroker<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Use container manifests from specified directory</span>
</span></span><span style="display:flex;"><span>root@qemux86-64:~# kanto-auto-deployer /data/var/containers/manifests/
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Running initial deployment of <span style="color:#4e9a06">&#34;/data/var/containers/manifests&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Reading manifests from <span style="color:#ce5c00;font-weight:bold">[</span>/data/var/containers/manifests<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z WARN  kanto_auto_deployer::manifest_parser<span style="color:#ce5c00;font-weight:bold">]</span> Failed to load manifest directly. Will attempt auto-conversion from init-dir format.
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Already exists <span style="color:#ce5c00;font-weight:bold">[</span>cloudconnector<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z WARN  kanto_auto_deployer::manifest_parser<span style="color:#ce5c00;font-weight:bold">]</span> Failed to load manifest directly. Will attempt auto-conversion from init-dir format.
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:27:44Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Already exists <span style="color:#ce5c00;font-weight:bold">[</span>databroker<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span></code></pre></div><blockquote>
<p>Nоte: The warnings from the manifest_parser module are normal and expected when the manifest is in the <a href="https://eclipse.dev/kanto/docs/references/containers/container-config/#template">Container Management Manifests Format</a></p>
</blockquote>
<h2 id="usage-as-systemd-service">Usage as systemd service</h2>
<p>In the Leda quickstart images, kanto-auto-deployer is installed as a systemd service.</p>
<blockquote>
<p>Note the service uses the <code>--daemon</code> flag that asks KAD to continuously monitor the specified directory (see last line of logs).</p>
</blockquote>
<p>The service unit configuration file is located in <code>/lib/systemd/system/kanto-auto-deployer.service</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>Unit<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">Description</span><span style="color:#ce5c00;font-weight:bold">=</span>Kanto Auto Deployer
</span></span><span style="display:flex;"><span><span style="color:#000">After</span><span style="color:#ce5c00;font-weight:bold">=</span>network-online.target container-management.service
</span></span><span style="display:flex;"><span><span style="color:#000">Wants</span><span style="color:#ce5c00;font-weight:bold">=</span>network-online.target container-management.service
</span></span><span style="display:flex;"><span><span style="color:#000">Requires</span><span style="color:#ce5c00;font-weight:bold">=</span>container-management.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>Install<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">WantedBy</span><span style="color:#ce5c00;font-weight:bold">=</span>multi-user.target
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">[</span>Service<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000">Restart</span><span style="color:#ce5c00;font-weight:bold">=</span>on-failure
</span></span><span style="display:flex;"><span><span style="color:#000">RestartSec</span><span style="color:#ce5c00;font-weight:bold">=</span>5s
</span></span><span style="display:flex;"><span><span style="color:#000">ExecStart</span><span style="color:#ce5c00;font-weight:bold">=</span>/usr/bin/kanto-auto-deployer /data/var/containers/manifests --daemon
</span></span></code></pre></div><p>Example output:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:/lib/systemd/system# systemctl status kanto-auto-deployer.service 
</span></span><span style="display:flex;"><span>* kanto-auto-deployer.service - Kanto Auto Deployer
</span></span><span style="display:flex;"><span>     Loaded: loaded <span style="color:#ce5c00;font-weight:bold">(</span>/lib/systemd/system/kanto-auto-deployer.service<span style="color:#000;font-weight:bold">;</span> enabled<span style="color:#000;font-weight:bold">;</span> vendor preset: enabled<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>     Active: active <span style="color:#ce5c00;font-weight:bold">(</span>running<span style="color:#ce5c00;font-weight:bold">)</span> since Tue 2023-04-18 10:22:10 UTC<span style="color:#000;font-weight:bold">;</span> 3min 55s ago
</span></span><span style="display:flex;"><span>   Main PID: <span style="color:#0000cf;font-weight:bold">525</span> <span style="color:#ce5c00;font-weight:bold">(</span>kanto-auto-depl<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>      Tasks: <span style="color:#0000cf;font-weight:bold">10</span> <span style="color:#ce5c00;font-weight:bold">(</span>limit: 4708<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>     Memory: 1.4M
</span></span><span style="display:flex;"><span>     CGroup: /system.slice/kanto-auto-deployer.service
</span></span><span style="display:flex;"><span>             <span style="color:#4e9a06">`</span>- <span style="color:#0000cf;font-weight:bold">525</span> /usr/bin/kanto-auto-deployer /data/var/containers/manifests --daemon
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:22:48 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:22:48Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Creating <span style="color:#ce5c00;font-weight:bold">[</span>sua<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:04 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:04Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Created <span style="color:#ce5c00;font-weight:bold">[</span>sua<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:04 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:04Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Starting <span style="color:#ce5c00;font-weight:bold">[</span>sua<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:05 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:05Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Started <span style="color:#ce5c00;font-weight:bold">[</span>sua<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:05 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:05Z WARN  kanto_auto_deployer::manifest_parser<span style="color:#ce5c00;font-weight:bold">]</span> Failed to load manifest directly. Will attempt auto-conversion from init-dir format.
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:05 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:05Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Creating <span style="color:#ce5c00;font-weight:bold">[</span>vum<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:10 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:10Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Created <span style="color:#ce5c00;font-weight:bold">[</span>vum<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:10 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:10Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Starting <span style="color:#ce5c00;font-weight:bold">[</span>vum<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:11 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:11Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Started <span style="color:#ce5c00;font-weight:bold">[</span>vum<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>Apr <span style="color:#0000cf;font-weight:bold">18</span> 10:23:11 qemux86-64 kanto-auto-deployer<span style="color:#ce5c00;font-weight:bold">[</span>525<span style="color:#ce5c00;font-weight:bold">]</span>: <span style="color:#ce5c00;font-weight:bold">[</span>2023-04-18T10:23:11Z INFO  kanto_auto_deployer<span style="color:#ce5c00;font-weight:bold">]</span> Running in daemon mode. Continuously monitoring <span style="color:#4e9a06">&#34;/data/var/containers/manifests&#34;</span>
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-67a8cb2fda94b33fb5cc6d522b276d75">8.8 - SDV Container Exec</h1>
    
	<p>The <code>sdv-ctr-exec</code> wrapper allows to execute arbitrary user commands in existing containers.
Kanto Container Management cli tool (<code>kanto-cm</code>) only allows to manage the lifecycle of a container,
but does not allow to specify or override the entrypoint or command definitions of an existing container.
The <code>ctr</code> command line tool of containerd allows the execution of additional <em>tasks</em> in a running container.</p>
<h2 id="usage">Usage</h2>
<p>As a convenient tool, <code>sdv-ctr-exec</code> allows the simple execution of arbitrary commands inside of containers.
This is especially useful for non-service-containers, or containers which have additional binaries (e.g. cli tools) embedded.</p>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@qemux86-64:~# sdv-ctr-exec 
</span></span><span style="display:flex;"><span>/usr/bin/sdv-ctr-exec -h to print this message
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Usage:
</span></span><span style="display:flex;"><span>/usr/bin/sdv-ctr-exec &lt;container-id&gt; &lt;command&gt;
</span></span><span style="display:flex;"><span>or
</span></span><span style="display:flex;"><span>/usr/bin/sdv-ctr-exec -n &lt;container-name&gt; &lt;command&gt;
</span></span></code></pre></div><p>Example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Executing a containerized cli tool using sdv-ctr-exec</span>
</span></span><span style="display:flex;"><span>kanto-cm create --i --t --network<span style="color:#ce5c00;font-weight:bold">=</span>host --name<span style="color:#ce5c00;font-weight:bold">=</span>kuksa-client ghcr.io/eclipse/kuksa.val/kuksa-client:master
</span></span><span style="display:flex;"><span>kanto-cm start --name<span style="color:#ce5c00;font-weight:bold">=</span>kuksa-client
</span></span><span style="display:flex;"><span>sdv-ctr-exec -n kuksa-client /kuksa-client/bin/kuksa-client --port <span style="color:#0000cf;font-weight:bold">30555</span> --protocol grpc --insecure
</span></span></code></pre></div><h2 id="alternatives">Alternatives</h2>
<h3 id="containerd-ctr">containerd: <code>ctr</code></h3>
<p>The above commands are equivalent to the following commands:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Executing a containerized cli tool using ctr</span>
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm image pull ghcr.io/eclipse/kuksa.val/kuksa-client:master
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm container create --net-host --tty ghcr.io/eclipse/kuksa.val/kuksa-client:master kuksa-client
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm tasks start --detach kuksa-client
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm tasks <span style="color:#204a87">exec</span> --tty --exec-id sometask kuksa-client /kuksa-client/bin/kuksa-client --port <span style="color:#0000cf;font-weight:bold">30555</span> --protocol grpc --insecure
</span></span></code></pre></div><h3 id="containerd-nerdctl">containerd: <code>nerdctl</code></h3>
<blockquote>
<p>Note: <code>nerdctl</code> is currently not installed on the Leda Quickstart images.</p>
</blockquote>
<h3 id="containerd-ctr-and-mounting">containerd: <code>ctr</code> and mounting</h3>
<p>To execute a binary natively (outside of a containerized environment), the container image may be mounted to the host filesystem using the <code>ctr snapshots mount</code> commands.</p>
<p>This approach only works if the binary is compatible with the host environment (dependencies, libraries etc.).</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#000">$CONTAINER_IMAGE</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;ghcr.io/my-org/my-project/my-container&#34;</span>
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm image pull <span style="color:#000">$CONTAINER_IMAGE</span>
</span></span><span style="display:flex;"><span>ctr --namespace kanto-cm container create --net-host --tty <span style="color:#000">$CONTAINER_IMAGE</span> my-container
</span></span><span style="display:flex;"><span>mkdir my-container
</span></span><span style="display:flex;"><span>ctr --namespace<span style="color:#ce5c00;font-weight:bold">=</span>kanto-cm snapshots mount my-container my-container <span style="color:#000;font-weight:bold">|</span> <span style="color:#000">$SHELL</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> my-container
</span></span><span style="display:flex;"><span>./bin/my-application --help
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-080b94ccd41bc5e866333b5c591b2719">8.9 - SDV Kanto-Ctl</h1>
    
	<p>Manage the Kanto Container Management configuration via CLI.</p>
<blockquote>
<p>Note: <strong>Requires</strong> <code>jq</code> to be installed.</p>
</blockquote>
<p>Features:</p>
<ul>
<li>Add and remove container registries (for authentication purposes)</li>
<li>Set primitive values in configuration</li>
<li>Restart <code>container-management.service</code> on configuration changes</li>
<li>Automatically back up configuration file</li>
<li>Display changes to user</li>
</ul>
<p><img src="../sdv-kanto-ctl-example-output1.png" alt="Eclipse Leda Kanto Container Manager Configuration utility"></p>
<h2 id="usage">Usage</h2>
<p>Synposis: <code>./sdv-kanto-ctl &lt;command&gt; [&lt;options&gt;]</code></p>
<p>Full help:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ./sdv-kanto-ctl --help
</span></span><span style="display:flex;"><span>Eclipse Kanto Container Manager Configuration Utility
</span></span><span style="display:flex;"><span>See https://eclipse.dev/kanto/docs/references/containers/container-manager-config/
</span></span><span style="display:flex;"><span>Usage: ./sdv-kanto-ctl &lt;command&gt; <span style="color:#ce5c00;font-weight:bold">{</span>options<span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>Commands:
</span></span><span style="display:flex;"><span>        add-registry -h &lt;hostname&gt; -u &lt;username&gt; -p &lt;password&gt;
</span></span><span style="display:flex;"><span>                Adds or replaces a container registry authentication configuration
</span></span><span style="display:flex;"><span>                -h or --hostname: Configure the hostname of the container registry <span style="color:#ce5c00;font-weight:bold">(</span>e.g. hub.docker.io, ghcr.io, ...<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                -u or --username: Configure the username
</span></span><span style="display:flex;"><span>                -p or --password: Configure the password
</span></span><span style="display:flex;"><span>        remove-registry -h &lt;hostname&gt;
</span></span><span style="display:flex;"><span>                Removes the specified container registry
</span></span><span style="display:flex;"><span>                -h or --hostname: The hostname of the container registry
</span></span><span style="display:flex;"><span>        remove-all-registries
</span></span><span style="display:flex;"><span>                Removes all configured container registries
</span></span><span style="display:flex;"><span>        list-registries
</span></span><span style="display:flex;"><span>                Prints all configured container registries
</span></span><span style="display:flex;"><span>        show-config
</span></span><span style="display:flex;"><span>                Print the container management configuration
</span></span><span style="display:flex;"><span>        <span style="color:#204a87">set</span> &lt;key&gt; &lt;value&gt;
</span></span><span style="display:flex;"><span>                Set a primitive configuration value. Key in JSON Dot-Notation
</span></span><span style="display:flex;"><span>                Examples: ./sdv-kanto-ctl <span style="color:#204a87">set</span> containers.registry_configurations.MyRegistry.credentials.password foobar
</span></span><span style="display:flex;"><span>                          ./sdv-kanto-ctl <span style="color:#204a87">set</span> things.enable <span style="color:#204a87">true</span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>        --no-reload : Do not reload the configuration and restart the container-management service automatically
</span></span><span style="display:flex;"><span>        --ansi : Don<span style="color:#a40000">&#39;</span>t use colored output.
</span></span><span style="display:flex;"><span>        --verbose <span style="color:#000;font-weight:bold">|</span> -v : Enable verbose mode.
</span></span><span style="display:flex;"><span>        --help : This message.
</span></span></code></pre></div><h3 id="example-private-container-registries">Example: Private Container Registries</h3>
<p>To be able to pull container images, the container runtime needs access to the container registry.
Some container registries require authentication.
The Kanto Container Manager can be configured to use credentials when accessing remote container registries.</p>
<p>In the Leda images, the <em>sdv-kanto-ctl</em> tools allows to easily add authentication to the container manager configuration:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-kanto-ctl add-registry -h &lt;registryhostname&gt; -u &lt;your_username&gt; -p &lt;your_password&gt;
</span></span></code></pre></div><p>For example, to access container images from GitHub Packages in a private repository, you need a GitHub Personal Access Token (PAT) with the <code>read: packages</code> scope.
Then, add the repository as shown below:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-kanto-ctl add-registry -h ghcr.io -u github -p &lt;Your_GitHub_PersonalAccessToken&gt;
</span></span></code></pre></div><p><em>sdv-kanto-ctl</em>  will make the necessary modifications to <code>/etc/container-management/config.json</code> and restarts the <code>container-management.service</code> systemd unit,
so that the changes take effect. You may need to recreate or restart the container if a previous pull failed.</p>
<p>Please see the <a href="https://eclipse.dev/kanto/docs/references/containers/container-manager-config/">Eclipse Kanto Container Manager Configuration reference</a>
for details.</p>
<h3 id="example-enabling-things-management">Example: Enabling Things management</h3>
<p>Enable the container manager digital twin representation.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-kanto-ctl <span style="color:#204a87">set</span> things.enable <span style="color:#204a87">true</span>
</span></span></code></pre></div><h3 id="example-container-stop-timeout">Example: Container Stop Timeout</h3>
<p>Kanto waits for a timeout before forcefully stopping a container.
The default is 30 seconds in Kanto, and 10 seconds in the Leda quickstart image.</p>
<p>To change this behavior at runtime:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sdv-kanto-ctl <span style="color:#204a87">set</span> manager.default_ctrs_stop_timeout <span style="color:#0000cf;font-weight:bold">2</span>
</span></span></code></pre></div>
</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-4ba9f4b2d2c150df2117dd655ecd1818">9 - Wifi Configuration</h1>
    
	<p>BSP packages for emulated WiFi devices (QEMU) and hardware device drivers are provided in <code>meta-leda</code> for <a href="../../customization/custom-images#hardware">supported hardware</a>.
They usually do not require extra configuration.</p>
<p>For a guide on how to connect to a wireless network check the <a href="connecting-to-wifi"><em>Connecting to Wi-Fi networks</em></a> page.</p>
<h2 id="raspberry-pi-4b-64">Raspberry Pi 4B 64</h2>
<p>The required kernel modules and binary blobs are provided with the <code>sdv-wifi-kernel-config.inc</code> config file and the <code>packagegroup-sdv-rpi4wifi</code> packagegroup. These
are included in <code>sdv-image-full.bb</code> and <code>sdv-image-minimal.bb</code> by default.</p>
<p>If you, however, decide to define your own custom image based on <a href="../../customization/custom-images"><em>Custom Distros</em></a>,
you would have to make sure the packagegroup is installed to enable WiFi connectivity.</p>
<h2 id="qemu">QEMU</h2>
<p>QEMU images provide the kernel modules necessary to set-up a virtual wlan interface and connect it to a virtual wifi network. This can be useful in various testing scenarios.</p>
<p>To create and link a virtual WiFi interface to eth0, boot your QEMU image and run:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ip link add link eth0 name wlan0 <span style="color:#204a87">type</span> virt_wifi
</span></span></code></pre></div><p>The SSID of the virtual network you can connect to is <code>VirtWifi</code>.</p>
<p><em>Note:</em> Leda Quickstart QEMU images set the name of the default virtual ethernet interface to <code>eth0</code> through kernel CMDLINE configurations (<code>net.ifnames=0 biosdevname=0</code>).
If you are building a custom image with a different kernel CMDLINE replace <code>eth0</code> with the name of your virtual interface (check <code>ifconfig</code>).</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-6e2aad457e20233b1a8166199667e51a">9.1 - Connecting to Wi-Fi networks</h1>
    
	<p>Here we will describe the basic steps on how to identify and connect to a WiFi network in interactive or headless mode.</p>
<h2 id="initial-steps-identifying-wlan-interfaces">Initial steps (identifying wlan interfaces)</h2>
<p>Start by running:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ip a
</span></span><span style="display:flex;"><span> ...
</span></span><span style="display:flex;"><span>3: wlan0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style="color:#0000cf;font-weight:bold">1500</span> qdisc fq_codel state DOWN group default qlen <span style="color:#0000cf;font-weight:bold">1000</span>
</span></span><span style="display:flex;"><span>    link/ether &lt;MAC&gt; brd ff:ff:ff:ff:ff:ff
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p><strong>Note:</strong> Usually the name of the interface would be <code>wlan0</code>. It might however follow the newer &ldquo;predictable interface names&rdquo; standart.
Then the interface name would start with <code>wl*</code> with the remaining characters identifying a physical bus/chip/number/etc
corresponding to the interface. For simplicity we will <code>wlan0</code> in all examples below.</p>
<p>Most likely your wlan interface would be in the state <code>DOWN</code>. To bring it up:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ip link <span style="color:#204a87">set</span> wlan0 up
</span></span></code></pre></div><h2 id="scanning-for-wireless-networks">Scanning for wireless networks</h2>
<p>You can scan for wireless networks using either <code>iw</code> or <code>wpa_cli</code>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ iw wlan0 scan
</span></span></code></pre></div><p><strong>Note:</strong> The output of this command can be quite verbose. You can grep for <code>SSID</code> to find the SSIDs of the networks around you.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ wpa_cli scan <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> wpa_cli scan_results
</span></span></code></pre></div><p>The output of <code>wpa_cli</code> is cleaner and more readable so it is recommended to use that.</p>
<h2 id="connecting-to-a-network">Connecting to a network</h2>
<p>Once you have identified the SSID of your network you can connect to it by ussing the following commands:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ wpa_passphrase &lt;SSID&gt; &lt;Passphrase&gt; &gt;&gt; /etc/wpa_supplicant.conf
</span></span><span style="display:flex;"><span>$ systemctl restart wpa
</span></span></code></pre></div><p>You should now be connected to the wireless network. To confirm that, you can once again use <code>ip a</code> to check that <code>wlan0</code> has been configured with an IP.</p>
<p>This configuration shall be remembered from now on and your interface will try to connect automaticatically to that network whenever it is available.</p>
<h2 id="headless-wi-fi-configuration">Headless Wi-Fi configuration</h2>
<p>Similarly to the Raspbian, meta-leda provides a mechanism for headless configuration of Wi-Fi credentials for your device (<a href="https://learn.sparkfun.com/tutorials/headless-raspberry-pi-setup/wifi-with-dhcp">Headless Raspberry Pi Setup</a>).</p>
<p>To use this feature you have to prepapre your <code>wpa_supplicant.conf</code> ahead of time (check the reference above):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>ctrl_interface=/var/run/wpa_supplicant
</span></span><span style="display:flex;"><span>ctrl_interface_group=0
</span></span><span style="display:flex;"><span>update_config=1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>network={
</span></span><span style="display:flex;"><span>        key_mgmt=NONE
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>network={
</span></span><span style="display:flex;"><span>    ssid=&#34;&lt;YOUR NETWORK NAME&gt;&#34;
</span></span><span style="display:flex;"><span>    psk=&#34;&lt;YOUR NETWORK PASSWORD&gt;&#34;
</span></span><span style="display:flex;"><span>    key_mgmt=WPA-PSK
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>IMPORTANT:</strong> It is recommended that if you are creating this configuration file on Windows to use an editor such as Notepad++ that can save files using the
&ldquo;Unix Line endings&rdquo; (<a href="https://www.cs.toronto.edu/~krueger/csc209h/tut/line-endings.html">DOS vs. Unix Line Endings</a>), or run it through a tool such as <code>dos2unix</code>
that can convert between the two file formats. Otherwise <code>wpa_supplicant.conf</code> might not be read properly in the Linux image.</p>
<p>Once you have your <code>wpa_supplicant.conf</code> put your SD-card in your Desktop machine and place the configuration file in the root of the <code>BOOT</code> partion.</p>
<p>When you boot your device it should now automatically connect to your Wi-Fi network.</p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-886a90f8e9ce27e2ae5a34b321aa0a97">10 - GPS Connectivity</h1>
    
	<h2 id="gpsd">GPSD</h2>
<p>Leda Quickstart Images provide (within meta-leda) recipes for the integration and setup of GPSD.
GPSD is a service daemon that monitors one or more GPSes or AIS receivers attached to a host computer through serial or USB ports,
making all data on the location/course/velocity of the sensors available to be queried on TCP port 2947
of the host computer. To find out more about GPSD, check out its <a href="https://gpsd.gitlab.io/gpsd/gpsd.html">official documentation</a>.</p>
<p>For easier interaction and debugging gpsd client utilities such as installed <a href="https://www.mankier.com/1/gpsfake">gpsfake</a>,
<a href="https://www.mankier.com/1/gpspipe">gpspipe</a>, etc. are installed.</p>
<h2 id="service">Service</h2>
<p>GPSD is installed on Leda Quickstart Images as a service. To check its status and/or logs you can use the following two commands:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@leda-525400123502:~# systemctl status gpsd.service
</span></span><span style="display:flex;"><span>* gpsd.service - GPS <span style="color:#ce5c00;font-weight:bold">(</span>Global Positioning System<span style="color:#ce5c00;font-weight:bold">)</span> Daemon
</span></span><span style="display:flex;"><span>     Loaded: loaded <span style="color:#ce5c00;font-weight:bold">(</span>/lib/systemd/system/gpsd.service<span style="color:#000;font-weight:bold">;</span> disabled<span style="color:#000;font-weight:bold">;</span> vendor preset: disabled<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>     Active: active <span style="color:#ce5c00;font-weight:bold">(</span>running<span style="color:#ce5c00;font-weight:bold">)</span> since Mon 2023-10-02 11:19:54 UTC<span style="color:#000;font-weight:bold">;</span> 41min ago
</span></span><span style="display:flex;"><span>     ...
</span></span></code></pre></div><p>and the socket:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@leda-525400123502:~# systemctl status gpsd.socket
</span></span><span style="display:flex;"><span>* gpsd.socket - GPS <span style="color:#ce5c00;font-weight:bold">(</span>Global Positioning System<span style="color:#ce5c00;font-weight:bold">)</span> Daemon Sockets
</span></span><span style="display:flex;"><span>     Loaded: loaded <span style="color:#ce5c00;font-weight:bold">(</span>/lib/systemd/system/gpsd.socket<span style="color:#000;font-weight:bold">;</span> enabled<span style="color:#000;font-weight:bold">;</span> vendor preset: enabled<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>     Active: active <span style="color:#ce5c00;font-weight:bold">(</span>running<span style="color:#ce5c00;font-weight:bold">)</span> since Mon 2023-10-02 11:19:30 UTC<span style="color:#000;font-weight:bold">;</span> 42min ago
</span></span><span style="display:flex;"><span>    ...
</span></span></code></pre></div><p>With the location of the default config file being:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>/etc/default/gpsd.default
</span></span></code></pre></div><p>By default, the GPSD service on Leda is configured to automatically discover USB devices (plug-and-play). In some cases, a system reboot might be required
after plugging the USB GPS device.</p>
<h2 id="kuksaval-feedergps">Kuksa.val FeederGPS</h2>
<p>The Kuksa GPS Feeder consumes gpsd as a data source and pushes location data to the kuksa.val server (databroker). It is installed as a pre-configured container on Leda Images
through the <a href="https://github.com/eclipse-leda/meta-leda/blob/main/meta-leda-components/recipes-sdv/eclipse-leda/kanto-containers/example/feedergps.json">feedergps.json container manifest</a>.
The container has an internal gpsd server (on port 2948) that connects to the host&rsquo;s gpsd instance (on port 2947). With the provided container manifest
feedergps should be plug-and-play.</p>
<h2 id="using-pre-recorder-gps-traces-with-gpsfake">Using pre-recorder GPS traces with gpsfake</h2>
<h3 id="recording-nmea-traces">Recording NMEA traces</h3>
<p>It sometimes might be useful to mock gps services when testing, especially on QEMU virtual machines where emulated USB GPS hardware is not available.
Pre-recorded traces should be in the NMEA-format.</p>
<p>To record a GPS trace in the NMEA format, on a device with physical GPS hardware, gpsd, and gpsd-client utilities installed, run:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gpspipe -R &gt; gps_log.nmea
</span></span></code></pre></div><p>A sample NEMA file that can be used for testing is provided in the kuksa.val.feeders repository - <a href="https://raw.githubusercontent.com/eclipse/kuksa.val.feeders/main/gps2val/simplelog_example.nmea">simplelog_example.nmea</a>.</p>
<h3 id="feeding-nmea-traces-to-feedergps">Feeding NMEA traces to feedergps</h3>
<p>Since the running gpsd service will interfere with the following steps, make sure to stop it first by running:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>systemctl stop gpsd.service
</span></span><span style="display:flex;"><span>systemctl stop gpsd.socket
</span></span></code></pre></div><p>To start gpsfake on port <em>2946</em> with <code>gps_log.nmea</code> as an input,
either in the background (by adding <code>&amp;</code> at the end of the shell line) or in a separate shell session run:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@leda-525400123502:~# gpsfake -P <span style="color:#0000cf;font-weight:bold">2946</span> gps_log.nmea
</span></span><span style="display:flex;"><span>/usr/bin/gpsfake:21: DeprecationWarning: The distutils package is deprecated and slated <span style="color:#204a87;font-weight:bold">for</span> removal in Python 3.12. Use setuptools or check PEP <span style="color:#0000cf;font-weight:bold">632</span> <span style="color:#204a87;font-weight:bold">for</span> potential alternatives
</span></span><span style="display:flex;"><span>  from distutils import spawn
</span></span><span style="display:flex;"><span>Processing gps_log.nmea
</span></span><span style="display:flex;"><span>gpsfake: log cycle of gps_log.nmea begins.
</span></span></code></pre></div><blockquote>
<p>Note:  you can safely ignore the distutils warning.</p>
</blockquote>
<p>Then, run a foreground instance of gpsd that reads from gpsfake on port <em>2946</em> on the loopback interface <strong>only</strong> and forwards
the traffic on port <em>2947</em> for <strong>all</strong> interfaces:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gpsd -GNS <span style="color:#0000cf;font-weight:bold">2947</span> gpsd://127.0.0.1:2946
</span></span></code></pre></div><blockquote>
<p>These extra steps are needed as feedergps requires the gpsd server on port 2947 to be available on the kanto-cm0 bridge, as it&rsquo;s running as a
container and gpsfake cannot be configured to listen on an interface different from the loopback.</p>
</blockquote>
<p>Restart feedergps:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kanto-cm stop -n feedergps
</span></span><span style="display:flex;"><span>kanto-cm start -n feedergps
</span></span></code></pre></div><h2 id="known-issues">Known issues</h2>
<p>Sometimes the feedergps container is started before the databroker and/or gpsd which leads to the container not being able to connect to either
of those services. In such cases, after you&rsquo;ve made sure the databroker and gpsd are up and running, restart feedergps with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kanto-cm stop -n feedergps
</span></span><span style="display:flex;"><span>kanto-cm start -n feedergps
</span></span></code></pre></div>
</div>



    
      
  
  
  
  

  
  

  

    
	
  



          </main>
        </div>
      </div>
      


<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/eclipse-leda" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        
        
        
          <p class="mt-2"><a href="/leda/docs/about/">About Leda</a></p>
        
      </div>
    </div>
    <div class="row">
      <div class="col-12 text-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org">
        Eclipse Foundation
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/privacy.php">
        Privacy Policy
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/termsofuse.php">
        Terms of Use
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/copyright.php">
        Copyright Agent
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/">
        Legal
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/legal/epl-2.0/">
        License
      </a>
    </small>
  </li>
  
  <li class="list-inline-item mx-2">
    <small class="ml-1">
      <a class="text-footer-menu" target="_blank" rel="noopener" href="https://eclipse.org/security/">
        Report a Vulnerability
      </a>
    </small>
  </li>
  
</ul>

        
        
      </div>
  </div>
</footer>


    </div>
    
  <script src="/leda/js/main.min.054f118c2d3b183635f9655daee6fcebd03931cb3727d1f12fe0dda1fd784631.js" integrity="sha256-BU8RjC07GDY1&#43;WVdrub869A5Mcs3J9HxL&#43;Ddof14RjE=" crossorigin="anonymous"></script>
<script defer src="/leda/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js" integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin="anonymous"></script>
<script src='/leda/js/tabpane-persist.js'></script>

  </body>
</html>
